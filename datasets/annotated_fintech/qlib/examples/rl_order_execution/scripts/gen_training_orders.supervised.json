[
  {
    "line": 5,
    "text": "import numpy as np",
    "annotation": "\u2705 Best Practice: Use of Path from pathlib for path operations improves code readability and cross-platform compatibility.",
    "confidence": 1.0,
    "tokens": [
      11748,
      299,
      32152,
      355,
      45941
    ],
    "start_token": 0,
    "end_token": 5,
    "annotation_tokens": [
      26486,
      227,
      6705,
      19939,
      25,
      5765,
      286,
      10644,
      422,
      3108,
      8019,
      329,
      3108,
      4560,
      19575,
      2438,
      1100,
      1799,
      290,
      3272,
      12,
      24254,
      17764,
      13
    ],
    "label": "best_practice",
    "reason": "Use of Path from pathlib for path operations improves code readability and cross-platform compatibility."
  },
  {
    "line": 7,
    "text": "",
    "annotation": "\u2705 Best Practice: Use of Path from pathlib for path operations improves code readability and cross-platform compatibility.",
    "confidence": 1.0,
    "tokens": [],
    "start_token": 5,
    "end_token": 5,
    "annotation_tokens": [
      26486,
      227,
      6705,
      19939,
      25,
      5765,
      286,
      10644,
      422,
      3108,
      8019,
      329,
      3108,
      4560,
      19575,
      2438,
      1100,
      1799,
      290,
      3272,
      12,
      24254,
      17764,
      13
    ],
    "label": "best_practice",
    "reason": "Use of Path from pathlib for path operations improves code readability and cross-platform compatibility."
  },
  {
    "line": 7,
    "text": "",
    "annotation": "\u26a0\ufe0f SAST Risk (Medium): Missing import statement for 'pd' (pandas), which can lead to NameError if not imported elsewhere.",
    "confidence": 1.0,
    "tokens": [],
    "start_token": 5,
    "end_token": 5,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      31205,
      2599,
      25639,
      1330,
      2643,
      329,
      705,
      30094,
      6,
      357,
      79,
      392,
      292,
      828,
      543,
      460,
      1085,
      284,
      6530,
      12331,
      611,
      407,
      17392,
      8057,
      13
    ],
    "label": "sast_risk",
    "severity": "Medium",
    "reason": "Missing import statement for 'pd' (pandas), which can lead to NameError if not imported elsewhere."
  },
  {
    "line": 8,
    "text": "from pathlib import Path",
    "annotation": "\u26a0\ufe0f SAST Risk (Medium): Missing import statement for 'np' (numpy), which can lead to NameError if not imported elsewhere.",
    "confidence": 1.0,
    "tokens": [
      6738,
      3108,
      8019,
      1330,
      10644
    ],
    "start_token": 5,
    "end_token": 10,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      31205,
      2599,
      25639,
      1330,
      2643,
      329,
      705,
      37659,
      6,
      357,
      77,
      32152,
      828,
      543,
      460,
      1085,
      284,
      6530,
      12331,
      611,
      407,
      17392,
      8057,
      13
    ],
    "label": "sast_risk",
    "severity": "Medium",
    "reason": "Missing import statement for 'np' (numpy), which can lead to NameError if not imported elsewhere."
  },
  {
    "line": 10,
    "text": "DATA_PATH = Path(os.path.join(\"data\", \"pickle\", \"backtest\"))",
    "annotation": "\u26a0\ufe0f SAST Risk (Medium): DATA_PATH is used without being defined in this scope, which can lead to NameError.",
    "confidence": 1.0,
    "tokens": [
      26947,
      62,
      34219,
      796,
      10644,
      7,
      418,
      13,
      6978,
      13,
      22179,
      7203,
      7890,
      1600,
      366,
      27729,
      293,
      1600,
      366,
      1891,
      9288,
      48774
    ],
    "start_token": 10,
    "end_token": 32,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      31205,
      2599,
      42865,
      62,
      34219,
      318,
      973,
      1231,
      852,
      5447,
      287,
      428,
      8354,
      11,
      543,
      460,
      1085,
      284,
      6530,
      12331,
      13
    ],
    "label": "sast_risk",
    "severity": "Medium",
    "reason": "DATA_PATH is used without being defined in this scope, which can lead to NameError."
  },
  {
    "line": 12,
    "text": "",
    "annotation": "\u26a0\ufe0f SAST Risk (Medium): Potential for AttributeError if 'handler' or 'fetch' is not defined in the dataset.",
    "confidence": 1.0,
    "tokens": [],
    "start_token": 32,
    "end_token": 32,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      31205,
      2599,
      32480,
      329,
      3460,
      4163,
      12331,
      611,
      705,
      30281,
      6,
      393,
      705,
      69,
      7569,
      6,
      318,
      407,
      5447,
      287,
      262,
      27039,
      13
    ],
    "label": "sast_risk",
    "severity": "Medium",
    "reason": "Potential for AttributeError if 'handler' or 'fetch' is not defined in the dataset."
  },
  {
    "line": 16,
    "text": "    df = dataset.handler.fetch(level=None).reset_index()",
    "annotation": "\u26a0\ufe0f SAST Risk (Medium): Potential KeyError if 'datetime' column is missing in df.",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      47764,
      796,
      27039,
      13,
      30281,
      13,
      69,
      7569,
      7,
      5715,
      28,
      14202,
      737,
      42503,
      62,
      9630,
      3419
    ],
    "start_token": 32,
    "end_token": 52,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      31205,
      2599,
      32480,
      7383,
      12331,
      611,
      705,
      19608,
      8079,
      6,
      5721,
      318,
      4814,
      287,
      47764,
      13
    ],
    "label": "sast_risk",
    "severity": "Medium",
    "reason": "Potential KeyError if 'datetime' column is missing in df."
  },
  {
    "line": 19,
    "text": "",
    "annotation": "\u26a0\ufe0f SAST Risk (Medium): Potential IndexError if the range is out of bounds for df.",
    "confidence": 0.5,
    "tokens": [],
    "start_token": 52,
    "end_token": 52,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      31205,
      2599,
      32480,
      12901,
      12331,
      611,
      262,
      2837,
      318,
      503,
      286,
      22303,
      329,
      47764,
      13
    ],
    "label": "sast_risk",
    "severity": "Medium",
    "reason": "Potential IndexError if the range is out of bounds for df."
  },
  {
    "line": 21,
    "text": "    df = df.set_index([\"instrument\", \"datetime\", \"date\"])",
    "annotation": "\u26a0\ufe0f SAST Risk (Medium): Potential KeyError if the expected levels are not present in the index.",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      47764,
      796,
      47764,
      13,
      2617,
      62,
      9630,
      7,
      14692,
      259,
      43872,
      1600,
      366,
      19608,
      8079,
      1600,
      366,
      4475,
      8973,
      8
    ],
    "start_token": 52,
    "end_token": 75,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      31205,
      2599,
      32480,
      7383,
      12331,
      611,
      262,
      2938,
      2974,
      389,
      407,
      1944,
      287,
      262,
      6376,
      13
    ],
    "label": "sast_risk",
    "severity": "Medium",
    "reason": "Potential KeyError if the expected levels are not present in the index."
  },
  {
    "line": 23,
    "text": "",
    "annotation": "\u26a0\ufe0f SAST Risk (Medium): Potential KeyError if '$volume0' column is missing in df.",
    "confidence": 0.5,
    "tokens": [],
    "start_token": 75,
    "end_token": 75,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      31205,
      2599,
      32480,
      7383,
      12331,
      611,
      705,
      3,
      29048,
      15,
      6,
      5721,
      318,
      4814,
      287,
      47764,
      13
    ],
    "label": "sast_risk",
    "severity": "Medium",
    "reason": "Potential KeyError if '$volume0' column is missing in df."
  },
  {
    "line": 27,
    "text": "    order_all[\"order_type\"] = 0",
    "annotation": "\u26a0\ufe0f SAST Risk (Medium): Potential KeyError if '$volume0' column is missing in order_all.",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      1502,
      62,
      439,
      14692,
      2875,
      62,
      4906,
      8973,
      796,
      657
    ],
    "start_token": 75,
    "end_token": 88,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      31205,
      2599,
      32480,
      7383,
      12331,
      611,
      705,
      3,
      29048,
      15,
      6,
      5721,
      318,
      4814,
      287,
      1502,
      62,
      439,
      13
    ],
    "label": "sast_risk",
    "severity": "Medium",
    "reason": "Potential KeyError if '$volume0' column is missing in order_all."
  },
  {
    "line": 29,
    "text": "",
    "annotation": "\u26a0\ufe0f SAST Risk (Medium): Potential KeyError if the expected levels are not present in the index.",
    "confidence": 0.5,
    "tokens": [],
    "start_token": 88,
    "end_token": 88,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      31205,
      2599,
      32480,
      7383,
      12331,
      611,
      262,
      2938,
      2974,
      389,
      407,
      1944,
      287,
      262,
      6376,
      13
    ],
    "label": "sast_risk",
    "severity": "Medium",
    "reason": "Potential KeyError if the expected levels are not present in the index."
  },
  {
    "line": 34,
    "text": "",
    "annotation": "\ud83e\udde0 ML Signal: Iterating over different data splits (train, valid, test) is a common pattern in ML workflows.",
    "confidence": 0.5,
    "tokens": [],
    "start_token": 88,
    "end_token": 88,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      40806,
      803,
      625,
      1180,
      1366,
      30778,
      357,
      27432,
      11,
      4938,
      11,
      1332,
      8,
      318,
      257,
      2219,
      3912,
      287,
      10373,
      670,
      44041,
      13
    ],
    "label": "ml_signal",
    "reason": "Iterating over different data splits (train, valid, test) is a common pattern in ML workflows."
  },
  {
    "line": 36,
    "text": "        path = OUTPUT_PATH / tag",
    "annotation": "\u26a0\ufe0f SAST Risk (Medium): OUTPUT_PATH is used without being defined in this scope, which can lead to NameError.",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      3108,
      796,
      16289,
      30076,
      62,
      34219,
      1220,
      7621
    ],
    "start_token": 88,
    "end_token": 103,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      31205,
      2599,
      16289,
      30076,
      62,
      34219,
      318,
      973,
      1231,
      852,
      5447,
      287,
      428,
      8354,
      11,
      543,
      460,
      1085,
      284,
      6530,
      12331,
      13
    ],
    "label": "sast_risk",
    "severity": "Medium",
    "reason": "OUTPUT_PATH is used without being defined in this scope, which can lead to NameError."
  },
  {
    "line": 38,
    "text": "        if len(order) > 0:",
    "annotation": "\u26a0\ufe0f SAST Risk (Low): os.makedirs can create directories with default permissions, which might be too permissive.",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      611,
      18896,
      7,
      2875,
      8,
      1875,
      657,
      25
    ],
    "start_token": 103,
    "end_token": 118,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      20535,
      2599,
      28686,
      13,
      76,
      4335,
      17062,
      460,
      2251,
      29196,
      351,
      4277,
      21627,
      11,
      543,
      1244,
      307,
      1165,
      583,
      33532,
      13
    ],
    "label": "sast_risk",
    "severity": "Low",
    "reason": "os.makedirs can create directories with default permissions, which might be too permissive."
  },
  {
    "line": 39,
    "text": "            order.to_pickle(path / f\"{stock}.pkl.target\")",
    "annotation": "\u26a0\ufe0f SAST Risk (Medium): Potential for overwriting existing files without warning.",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      1502,
      13,
      1462,
      62,
      27729,
      293,
      7,
      6978,
      1220,
      277,
      1,
      90,
      13578,
      27422,
      79,
      41582,
      13,
      16793,
      4943
    ],
    "start_token": 118,
    "end_token": 148,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      31205,
      2599,
      32480,
      329,
      6993,
      799,
      278,
      4683,
      3696,
      1231,
      6509,
      13
    ],
    "label": "sast_risk",
    "severity": "Medium",
    "reason": "Potential for overwriting existing files without warning."
  },
  {
    "line": 39,
    "text": "            order.to_pickle(path / f\"{stock}.pkl.target\")",
    "annotation": "\u2705 Best Practice: Setting a random seed ensures reproducibility of results.",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      1502,
      13,
      1462,
      62,
      27729,
      293,
      7,
      6978,
      1220,
      277,
      1,
      90,
      13578,
      27422,
      79,
      41582,
      13,
      16793,
      4943
    ],
    "start_token": 148,
    "end_token": 178,
    "annotation_tokens": [
      26486,
      227,
      6705,
      19939,
      25,
      25700,
      257,
      4738,
      9403,
      19047,
      8186,
      66,
      2247,
      286,
      2482,
      13
    ],
    "label": "best_practice",
    "reason": "Setting a random seed ensures reproducibility of results."
  },
  {
    "line": 39,
    "text": "            order.to_pickle(path / f\"{stock}.pkl.target\")",
    "annotation": "\u26a0\ufe0f SAST Risk (Medium): DATA_PATH is used without being defined in this scope, which can lead to NameError.",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      1502,
      13,
      1462,
      62,
      27729,
      293,
      7,
      6978,
      1220,
      277,
      1,
      90,
      13578,
      27422,
      79,
      41582,
      13,
      16793,
      4943
    ],
    "start_token": 178,
    "end_token": 208,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      31205,
      2599,
      42865,
      62,
      34219,
      318,
      973,
      1231,
      852,
      5447,
      287,
      428,
      8354,
      11,
      543,
      460,
      1085,
      284,
      6530,
      12331,
      13
    ],
    "label": "sast_risk",
    "severity": "Medium",
    "reason": "DATA_PATH is used without being defined in this scope, which can lead to NameError."
  },
  {
    "line": 39,
    "text": "            order.to_pickle(path / f\"{stock}.pkl.target\")",
    "annotation": "\ud83e\udde0 ML Signal: Extracting stock names from filenames is a common preprocessing step in financial data analysis.",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      1502,
      13,
      1462,
      62,
      27729,
      293,
      7,
      6978,
      1220,
      277,
      1,
      90,
      13578,
      27422,
      79,
      41582,
      13,
      16793,
      4943
    ],
    "start_token": 208,
    "end_token": 238,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      29677,
      278,
      4283,
      3891,
      422,
      1226,
      268,
      1047,
      318,
      257,
      2219,
      662,
      36948,
      2239,
      287,
      3176,
      1366,
      3781,
      13
    ],
    "label": "ml_signal",
    "reason": "Extracting stock names from filenames is a common preprocessing step in financial data analysis."
  },
  {
    "line": 39,
    "text": "            order.to_pickle(path / f\"{stock}.pkl.target\")",
    "annotation": "\ud83e\udde0 ML Signal: Shuffling data is a common practice to ensure randomness in training/testing datasets.",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      1502,
      13,
      1462,
      62,
      27729,
      293,
      7,
      6978,
      1220,
      277,
      1,
      90,
      13578,
      27422,
      79,
      41582,
      13,
      16793,
      4943
    ],
    "start_token": 238,
    "end_token": 268,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      911,
      1648,
      1359,
      1366,
      318,
      257,
      2219,
      3357,
      284,
      4155,
      4738,
      1108,
      287,
      3047,
      14,
      33407,
      40522,
      13
    ],
    "label": "ml_signal",
    "reason": "Shuffling data is a common practice to ensure randomness in training/testing datasets."
  },
  {
    "line": 39,
    "text": "            order.to_pickle(path / f\"{stock}.pkl.target\")",
    "annotation": "\ud83e\udde0 ML Signal: Limiting the number of processed items is a common pattern to manage computational resources.",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      1502,
      13,
      1462,
      62,
      27729,
      293,
      7,
      6978,
      1220,
      277,
      1,
      90,
      13578,
      27422,
      79,
      41582,
      13,
      16793,
      4943
    ],
    "start_token": 268,
    "end_token": 298,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      7576,
      1780,
      262,
      1271,
      286,
      13686,
      3709,
      318,
      257,
      2219,
      3912,
      284,
      6687,
      31350,
      4133,
      13
    ],
    "label": "ml_signal",
    "reason": "Limiting the number of processed items is a common pattern to manage computational resources."
  }
]