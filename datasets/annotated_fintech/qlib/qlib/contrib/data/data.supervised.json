[
  {
    "line": 4,
    "text": "# We remove arctic from core framework of Qlib to contrib due to",
    "annotation": "\u26a0\ufe0f SAST Risk (Medium): Importing from qlib.data.data could introduce security risks if the library is not properly maintained or if it executes untrusted code.",
    "confidence": 0.5,
    "tokens": [
      2,
      775,
      4781,
      610,
      11048,
      422,
      4755,
      9355,
      286,
      1195,
      8019,
      284,
      542,
      822,
      2233,
      284
    ],
    "start_token": 0,
    "end_token": 16,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      31205,
      2599,
      17267,
      278,
      422,
      10662,
      8019,
      13,
      7890,
      13,
      7890,
      714,
      10400,
      2324,
      7476,
      611,
      262,
      5888,
      318,
      407,
      6105,
      9456,
      393,
      611,
      340,
      42985,
      1418,
      81,
      8459,
      2438,
      13
    ],
    "label": "sast_risk",
    "severity": "Medium",
    "reason": "Importing from qlib.data.data could introduce security risks if the library is not properly maintained or if it executes untrusted code."
  },
  {
    "line": 9,
    "text": "",
    "annotation": "\u26a0\ufe0f SAST Risk (Low): Using a mutable default value for market_transaction_time_list can lead to unexpected behavior if modified.",
    "confidence": 0.5,
    "tokens": [],
    "start_token": 16,
    "end_token": 16,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      20535,
      2599,
      8554,
      257,
      4517,
      540,
      4277,
      1988,
      329,
      1910,
      62,
      7645,
      2673,
      62,
      2435,
      62,
      4868,
      460,
      1085,
      284,
      10059,
      4069,
      611,
      9518,
      13
    ],
    "label": "sast_risk",
    "severity": "Low",
    "reason": "Using a mutable default value for market_transaction_time_list can lead to unexpected behavior if modified."
  },
  {
    "line": 11,
    "text": "# `pip install arctic` may not be enough.",
    "annotation": "\ud83e\udde0 ML Signal: Storing the uri parameter, which could be used to identify network patterns or configurations.",
    "confidence": 0.5,
    "tokens": [
      2,
      4600,
      79,
      541,
      2721,
      610,
      11048,
      63,
      743,
      407,
      307,
      1576,
      13
    ],
    "start_token": 16,
    "end_token": 29,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      520,
      3255,
      262,
      2956,
      72,
      11507,
      11,
      543,
      714,
      307,
      973,
      284,
      5911,
      3127,
      7572,
      393,
      25412,
      13
    ],
    "label": "ml_signal",
    "reason": "Storing the uri parameter, which could be used to identify network patterns or configurations."
  },
  {
    "line": 13,
    "text": "import pandas as pd",
    "annotation": "\ud83e\udde0 ML Signal: Storing the retry_time parameter, which could be used to identify retry logic or patterns.",
    "confidence": 0.5,
    "tokens": [
      11748,
      19798,
      292,
      355,
      279,
      67
    ],
    "start_token": 29,
    "end_token": 35,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      520,
      3255,
      262,
      1005,
      563,
      62,
      2435,
      11507,
      11,
      543,
      714,
      307,
      973,
      284,
      5911,
      1005,
      563,
      9156,
      393,
      7572,
      13
    ],
    "label": "ml_signal",
    "reason": "Storing the retry_time parameter, which could be used to identify retry logic or patterns."
  },
  {
    "line": 15,
    "text": "",
    "annotation": "\ud83e\udde0 ML Signal: Storing the market_transaction_time_list parameter, which could be used to identify time-based patterns or configurations.",
    "confidence": 0.5,
    "tokens": [],
    "start_token": 35,
    "end_token": 35,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      520,
      3255,
      262,
      1910,
      62,
      7645,
      2673,
      62,
      2435,
      62,
      4868,
      11507,
      11,
      543,
      714,
      307,
      973,
      284,
      5911,
      640,
      12,
      3106,
      7572,
      393,
      25412,
      13
    ],
    "label": "ml_signal",
    "reason": "Storing the market_transaction_time_list parameter, which could be used to identify time-based patterns or configurations."
  },
  {
    "line": 14,
    "text": "import pymongo",
    "annotation": "\ud83e\udde0 ML Signal: Conversion of field to string might indicate dynamic field handling",
    "confidence": 1.0,
    "tokens": [
      11748,
      279,
      4948,
      25162
    ],
    "start_token": 35,
    "end_token": 39,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      44101,
      286,
      2214,
      284,
      4731,
      1244,
      7603,
      8925,
      2214,
      9041
    ],
    "label": "ml_signal",
    "reason": "Conversion of field to string might indicate dynamic field handling"
  },
  {
    "line": 16,
    "text": "from qlib.data.data import FeatureProvider",
    "annotation": "\u26a0\ufe0f SAST Risk (Low): Potential exposure to NoSQL injection if `self.uri` is not properly sanitized",
    "confidence": 1.0,
    "tokens": [
      6738,
      10662,
      8019,
      13,
      7890,
      13,
      7890,
      1330,
      27018,
      29495
    ],
    "start_token": 39,
    "end_token": 49,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      20535,
      2599,
      32480,
      7111,
      284,
      1400,
      17861,
      16954,
      611,
      4600,
      944,
      13,
      9900,
      63,
      318,
      407,
      6105,
      5336,
      36951
    ],
    "label": "sast_risk",
    "severity": "Low",
    "reason": "Potential exposure to NoSQL injection if `self.uri` is not properly sanitized"
  },
  {
    "line": 18,
    "text": "",
    "annotation": "\ud83e\udde0 ML Signal: Use of Arctic library for time-series data management",
    "confidence": 1.0,
    "tokens": [],
    "start_token": 49,
    "end_token": 49,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      5765,
      286,
      15723,
      5888,
      329,
      640,
      12,
      25076,
      1366,
      4542
    ],
    "label": "ml_signal",
    "reason": "Use of Arctic library for time-series data management"
  },
  {
    "line": 20,
    "text": "    def __init__(",
    "annotation": "\u2705 Best Practice: Check if the frequency library exists before proceeding",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      825,
      11593,
      15003,
      834,
      7
    ],
    "start_token": 49,
    "end_token": 57,
    "annotation_tokens": [
      26486,
      227,
      6705,
      19939,
      25,
      6822,
      611,
      262,
      8373,
      5888,
      7160,
      878,
      18788
    ],
    "label": "best_practice",
    "reason": "Check if the frequency library exists before proceeding"
  },
  {
    "line": 23,
    "text": "        super().__init__()",
    "annotation": "\u2705 Best Practice: Check if the instrument exists in the specified library",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      2208,
      22446,
      834,
      15003,
      834,
      3419
    ],
    "start_token": 57,
    "end_token": 70,
    "annotation_tokens": [
      26486,
      227,
      6705,
      19939,
      25,
      6822,
      611,
      262,
      8875,
      7160,
      287,
      262,
      7368,
      5888
    ],
    "label": "best_practice",
    "reason": "Check if the instrument exists in the specified library"
  },
  {
    "line": 25,
    "text": "        # TODO:",
    "annotation": "\ud83e\udde0 ML Signal: Reading a specific range of data from Arctic",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      1303,
      16926,
      46,
      25
    ],
    "start_token": 70,
    "end_token": 81,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      11725,
      257,
      2176,
      2837,
      286,
      1366,
      422,
      15723
    ],
    "label": "ml_signal",
    "reason": "Reading a specific range of data from Arctic"
  },
  {
    "line": 31,
    "text": "",
    "annotation": "\u2705 Best Practice: Check if the series is empty before processing",
    "confidence": 1.0,
    "tokens": [],
    "start_token": 81,
    "end_token": 81,
    "annotation_tokens": [
      26486,
      227,
      6705,
      19939,
      25,
      6822,
      611,
      262,
      2168,
      318,
      6565,
      878,
      7587
    ],
    "label": "best_practice",
    "reason": "Check if the series is empty before processing"
  },
  {
    "line": 31,
    "text": "",
    "annotation": "\ud83e\udde0 ML Signal: Filtering data based on market transaction times",
    "confidence": 1.0,
    "tokens": [],
    "start_token": 81,
    "end_token": 81,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      7066,
      20212,
      1366,
      1912,
      319,
      1910,
      8611,
      1661
    ],
    "label": "ml_signal",
    "reason": "Filtering data based on market transaction times"
  }
]