[
  {
    "line": 2,
    "text": "import pandas as pd",
    "annotation": "\u2705 Best Practice: Grouping imports from the same package together improves readability.",
    "confidence": 1.0,
    "tokens": [
      11748,
      19798,
      292,
      355,
      279,
      67
    ],
    "start_token": 0,
    "end_token": 6,
    "annotation_tokens": [
      26486,
      227,
      6705,
      19939,
      25,
      4912,
      278,
      17944,
      422,
      262,
      976,
      5301,
      1978,
      19575,
      1100,
      1799,
      13
    ],
    "label": "best_practice",
    "reason": "Grouping imports from the same package together improves readability."
  },
  {
    "line": 7,
    "text": "from zvt.domain import StockValuation, Etf, EtfValuation",
    "annotation": "\u2705 Best Practice: Grouping imports from the same package together improves readability.",
    "confidence": 1.0,
    "tokens": [
      6738,
      1976,
      36540,
      13,
      27830,
      1330,
      10500,
      7762,
      2288,
      11,
      17906,
      69,
      11,
      17906,
      69,
      7762,
      2288
    ],
    "start_token": 6,
    "end_token": 23,
    "annotation_tokens": [
      26486,
      227,
      6705,
      19939,
      25,
      4912,
      278,
      17944,
      422,
      262,
      976,
      5301,
      1978,
      19575,
      1100,
      1799,
      13
    ],
    "label": "best_practice",
    "reason": "Grouping imports from the same package together improves readability."
  },
  {
    "line": 9,
    "text": "from zvt.utils.time_utils import now_pd_timestamp",
    "annotation": "\ud83e\udde0 ML Signal: Inheritance from TimeSeriesDataRecorder indicates a pattern of extending functionality",
    "confidence": 1.0,
    "tokens": [
      6738,
      1976,
      36540,
      13,
      26791,
      13,
      2435,
      62,
      26791,
      1330,
      783,
      62,
      30094,
      62,
      16514,
      27823
    ],
    "start_token": 23,
    "end_token": 39,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      47025,
      42942,
      422,
      3862,
      27996,
      6601,
      6690,
      2875,
      9217,
      257,
      3912,
      286,
      16610,
      11244
    ],
    "label": "ml_signal",
    "reason": "Inheritance from TimeSeriesDataRecorder indicates a pattern of extending functionality"
  },
  {
    "line": 11,
    "text": "",
    "annotation": "\ud83e\udde0 ML Signal: Use of a string to specify a provider, indicating a pattern of configuration",
    "confidence": 1.0,
    "tokens": [],
    "start_token": 39,
    "end_token": 39,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      5765,
      286,
      257,
      4731,
      284,
      11986,
      257,
      10131,
      11,
      12739,
      257,
      3912,
      286,
      8398
    ],
    "label": "ml_signal",
    "reason": "Use of a string to specify a provider, indicating a pattern of configuration"
  },
  {
    "line": 13,
    "text": "    entity_provider = \"joinquant\"",
    "annotation": "\ud83e\udde0 ML Signal: Use of a schema class, indicating a pattern of data structure definition",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      9312,
      62,
      15234,
      1304,
      796,
      366,
      7639,
      18934,
      415,
      1
    ],
    "start_token": 39,
    "end_token": 52,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      5765,
      286,
      257,
      32815,
      1398,
      11,
      12739,
      257,
      3912,
      286,
      1366,
      4645,
      6770
    ],
    "label": "ml_signal",
    "reason": "Use of a schema class, indicating a pattern of data structure definition"
  },
  {
    "line": 15,
    "text": "",
    "annotation": "\ud83e\udde0 ML Signal: Repeated use of provider string, reinforcing configuration pattern",
    "confidence": 0.5,
    "tokens": [],
    "start_token": 52,
    "end_token": 52,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      30558,
      515,
      779,
      286,
      10131,
      4731,
      11,
      40991,
      8398,
      3912
    ],
    "label": "ml_signal",
    "reason": "Repeated use of provider string, reinforcing configuration pattern"
  },
  {
    "line": 17,
    "text": "    provider = \"joinquant\"",
    "annotation": "\ud83e\udde0 ML Signal: Use of a schema class, indicating a pattern of data structure definition",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      10131,
      796,
      366,
      7639,
      18934,
      415,
      1
    ],
    "start_token": 52,
    "end_token": 62,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      5765,
      286,
      257,
      32815,
      1398,
      11,
      12739,
      257,
      3912,
      286,
      1366,
      4645,
      6770
    ],
    "label": "ml_signal",
    "reason": "Use of a schema class, indicating a pattern of data structure definition"
  },
  {
    "line": 78,
    "text": "                        positive_df[\"count\"] = 1",
    "annotation": "\u26a0\ufe0f SAST Risk (Low): Code execution starts from the main block, ensure inputs are sanitized if used.",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      3967,
      62,
      7568,
      14692,
      9127,
      8973,
      796,
      352
    ],
    "start_token": 62,
    "end_token": 93,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      20535,
      2599,
      6127,
      9706,
      4940,
      422,
      262,
      1388,
      2512,
      11,
      4155,
      17311,
      389,
      5336,
      36951,
      611,
      973,
      13
    ],
    "label": "sast_risk",
    "severity": "Low",
    "reason": "Code execution starts from the main block, ensure inputs are sanitized if used."
  },
  {
    "line": 80,
    "text": "                        if pd_is_not_null(positive_df):",
    "annotation": "\ud83e\udde0 ML Signal: Usage of a specific class with a method call pattern",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      611,
      279,
      67,
      62,
      271,
      62,
      1662,
      62,
      8423,
      7,
      24561,
      62,
      7568,
      2599
    ],
    "start_token": 93,
    "end_token": 130,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      29566,
      286,
      257,
      2176,
      1398,
      351,
      257,
      2446,
      869,
      3912
    ],
    "label": "ml_signal",
    "reason": "Usage of a specific class with a method call pattern"
  },
  {
    "line": 80,
    "text": "                        if pd_is_not_null(positive_df):",
    "annotation": "\ud83e\udde0 ML Signal: Defining the public API of the module",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      611,
      279,
      67,
      62,
      271,
      62,
      1662,
      62,
      8423,
      7,
      24561,
      62,
      7568,
      2599
    ],
    "start_token": 130,
    "end_token": 167,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      2896,
      3191,
      262,
      1171,
      7824,
      286,
      262,
      8265
    ],
    "label": "ml_signal",
    "reason": "Defining the public API of the module"
  }
]