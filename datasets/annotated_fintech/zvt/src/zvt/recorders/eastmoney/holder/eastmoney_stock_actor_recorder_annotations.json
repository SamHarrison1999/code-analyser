[
  {
    "line": 2,
    "text": "import requests",
    "annotation": "\u2705 Best Practice: Group imports into standard library, third-party, and local sections for readability.",
    "confidence": 1.0,
    "tokens": [
      11748,
      7007
    ],
    "start_token": 0,
    "end_token": 2,
    "annotation_tokens": [
      26486,
      227,
      6705,
      19939,
      25,
      4912,
      17944,
      656,
      3210,
      5888,
      11,
      2368,
      12,
      10608,
      11,
      290,
      1957,
      9004,
      329,
      1100,
      1799,
      13
    ],
    "label": "best_practice",
    "reason": "Group imports into standard library, third-party, and local sections for readability."
  },
  {
    "line": 7,
    "text": "from zvt.utils.time_utils import to_pd_timestamp",
    "annotation": "\ud83e\udde0 ML Signal: Class definition with inheritance, useful for understanding class hierarchies and relationships.",
    "confidence": 0.5,
    "tokens": [
      6738,
      1976,
      36540,
      13,
      26791,
      13,
      2435,
      62,
      26791,
      1330,
      284,
      62,
      30094,
      62,
      16514,
      27823
    ],
    "start_token": 2,
    "end_token": 18,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      5016,
      6770,
      351,
      24155,
      11,
      4465,
      329,
      4547,
      1398,
      28398,
      444,
      290,
      6958,
      13
    ],
    "label": "ml_signal",
    "reason": "Class definition with inheritance, useful for understanding class hierarchies and relationships."
  },
  {
    "line": 9,
    "text": "",
    "annotation": "\ud83e\udde0 ML Signal: Static class attribute, useful for understanding default configurations or constants.",
    "confidence": 0.5,
    "tokens": [],
    "start_token": 18,
    "end_token": 18,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      36125,
      1398,
      11688,
      11,
      4465,
      329,
      4547,
      4277,
      25412,
      393,
      38491,
      13
    ],
    "label": "ml_signal",
    "reason": "Static class attribute, useful for understanding default configurations or constants."
  },
  {
    "line": 11,
    "text": "    name = \"eastmoney_actor_recorder\"",
    "annotation": "\ud83e\udde0 ML Signal: Static class attribute, useful for understanding default configurations or constants.",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      1438,
      796,
      366,
      23316,
      26316,
      62,
      11218,
      62,
      8344,
      2875,
      1
    ],
    "start_token": 18,
    "end_token": 32,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      36125,
      1398,
      11688,
      11,
      4465,
      329,
      4547,
      4277,
      25412,
      393,
      38491,
      13
    ],
    "label": "ml_signal",
    "reason": "Static class attribute, useful for understanding default configurations or constants."
  },
  {
    "line": 13,
    "text": "    data_schema = ActorMeta",
    "annotation": "\ud83e\udde0 ML Signal: Static class attribute, useful for understanding default configurations or constants.",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      1366,
      62,
      15952,
      2611,
      796,
      27274,
      48526
    ],
    "start_token": 32,
    "end_token": 42,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      36125,
      1398,
      11688,
      11,
      4465,
      329,
      4547,
      4277,
      25412,
      393,
      38491,
      13
    ],
    "label": "ml_signal",
    "reason": "Static class attribute, useful for understanding default configurations or constants."
  },
  {
    "line": 15,
    "text": "    url = \"https://datacenter.eastmoney.com/securities/api/data/v1/get?reportName=RPT_FREEHOLDERS_BASIC_INFO&columns=HOLDER_NAME,END_DATE,HOLDER_NEW,HOLDER_NUM,HOLDER_CODE&quoteColumns=&filter=(END_DATE='{}')&pageNumber={}&pageSize={}&sortTypes=-1,-1&sortColumns=HOLDER_NUM,HOLDER_NAME&source=SECURITIES&client=SW\"",
    "annotation": "\u26a0\ufe0f SAST Risk (Low): Hardcoded URL, potential for misuse if not validated or sanitized.",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      19016,
      796,
      366,
      5450,
      1378,
      19608,
      330,
      9255,
      13,
      23316,
      26316,
      13,
      785,
      14,
      2363,
      10886,
      14,
      15042,
      14,
      7890,
      14,
      85,
      16,
      14,
      1136,
      30,
      13116,
      5376,
      28,
      49,
      11571,
      62,
      39274,
      39,
      15173,
      4877,
      62,
      33,
      1921,
      2149,
      62,
      10778,
      5,
      28665,
      82,
      28,
      39,
      3535,
      14418,
      62,
      20608,
      11,
      10619,
      62,
      35,
      6158,
      11,
      39,
      3535,
      14418,
      62,
      13965,
      11,
      39,
      3535,
      14418,
      62,
      41359,
      11,
      39,
      3535,
      14418,
      62,
      34,
      16820,
      5,
      22708,
      39470,
      82,
      28,
      5,
      24455,
      16193,
      10619,
      62,
      35,
      6158,
      11639,
      90,
      92,
      11537,
      5,
      7700,
      15057,
      34758,
      92,
      5,
      7700,
      10699,
      34758,
      92,
      5,
      30619,
      31431,
      10779,
      16,
      12095,
      16,
      5,
      30619,
      39470,
      82,
      28,
      39,
      3535,
      14418,
      62,
      41359,
      11,
      39,
      3535,
      14418,
      62,
      20608,
      5,
      10459,
      28,
      23683,
      4261,
      30383,
      5,
      16366,
      28,
      17887,
      1
    ],
    "start_token": 42,
    "end_token": 180,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      20535,
      2599,
      6912,
      40976,
      10289,
      11,
      2785,
      329,
      29169,
      611,
      407,
      31031,
      393,
      5336,
      36951,
      13
    ],
    "label": "sast_risk",
    "severity": "Low",
    "reason": "Hardcoded URL, potential for misuse if not validated or sanitized."
  },
  {
    "line": 17,
    "text": "    start = \"2016-03-31\"",
    "annotation": "\ud83e\udde0 ML Signal: Static class attribute, useful for understanding default configurations or constants.",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      923,
      796,
      366,
      5304,
      12,
      3070,
      12,
      3132,
      1
    ],
    "start_token": 180,
    "end_token": 192,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      36125,
      1398,
      11688,
      11,
      4465,
      329,
      4547,
      4277,
      25412,
      393,
      38491,
      13
    ],
    "label": "ml_signal",
    "reason": "Static class attribute, useful for understanding default configurations or constants."
  },
  {
    "line": 12,
    "text": "    provider = \"eastmoney\"",
    "annotation": "\u26a0\ufe0f SAST Risk (Medium): Potential for server-side request forgery (SSRF) if `self.url` is user-controlled",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      10131,
      796,
      366,
      23316,
      26316,
      1
    ],
    "start_token": 192,
    "end_token": 201,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      31205,
      2599,
      32480,
      329,
      4382,
      12,
      1589,
      2581,
      329,
      7076,
      357,
      5432,
      32754,
      8,
      611,
      4600,
      944,
      13,
      6371,
      63,
      318,
      2836,
      12,
      14401
    ],
    "label": "sast_risk",
    "severity": "Medium",
    "reason": "Potential for server-side request forgery (SSRF) if `self.url` is user-controlled"
  },
  {
    "line": 13,
    "text": "    data_schema = ActorMeta",
    "annotation": "\u26a0\ufe0f SAST Risk (Low): No error handling for the HTTP request, which may lead to unhandled exceptions",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      1366,
      62,
      15952,
      2611,
      796,
      27274,
      48526
    ],
    "start_token": 201,
    "end_token": 211,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      20535,
      2599,
      1400,
      4049,
      9041,
      329,
      262,
      14626,
      2581,
      11,
      543,
      743,
      1085,
      284,
      555,
      38788,
      13269
    ],
    "label": "sast_risk",
    "severity": "Low",
    "reason": "No error handling for the HTTP request, which may lead to unhandled exceptions"
  },
  {
    "line": 14,
    "text": "",
    "annotation": "\u2705 Best Practice: Consider adding a timeout to the HTTP request to prevent hanging indefinitely",
    "confidence": 1.0,
    "tokens": [],
    "start_token": 211,
    "end_token": 211,
    "annotation_tokens": [
      26486,
      227,
      6705,
      19939,
      25,
      12642,
      4375,
      257,
      26827,
      284,
      262,
      14626,
      2581,
      284,
      2948,
      10938,
      24391
    ],
    "label": "best_practice",
    "reason": "Consider adding a timeout to the HTTP request to prevent hanging indefinitely"
  },
  {
    "line": 15,
    "text": "    url = \"https://datacenter.eastmoney.com/securities/api/data/v1/get?reportName=RPT_FREEHOLDERS_BASIC_INFO&columns=HOLDER_NAME,END_DATE,HOLDER_NEW,HOLDER_NUM,HOLDER_CODE&quoteColumns=&filter=(END_DATE='{}')&pageNumber={}&pageSize={}&sortTypes=-1,-1&sortColumns=HOLDER_NUM,HOLDER_NAME&source=SECURITIES&client=SW\"",
    "annotation": "\ud83e\udde0 ML Signal: Usage of external HTTP requests to fetch data",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      19016,
      796,
      366,
      5450,
      1378,
      19608,
      330,
      9255,
      13,
      23316,
      26316,
      13,
      785,
      14,
      2363,
      10886,
      14,
      15042,
      14,
      7890,
      14,
      85,
      16,
      14,
      1136,
      30,
      13116,
      5376,
      28,
      49,
      11571,
      62,
      39274,
      39,
      15173,
      4877,
      62,
      33,
      1921,
      2149,
      62,
      10778,
      5,
      28665,
      82,
      28,
      39,
      3535,
      14418,
      62,
      20608,
      11,
      10619,
      62,
      35,
      6158,
      11,
      39,
      3535,
      14418,
      62,
      13965,
      11,
      39,
      3535,
      14418,
      62,
      41359,
      11,
      39,
      3535,
      14418,
      62,
      34,
      16820,
      5,
      22708,
      39470,
      82,
      28,
      5,
      24455,
      16193,
      10619,
      62,
      35,
      6158,
      11639,
      90,
      92,
      11537,
      5,
      7700,
      15057,
      34758,
      92,
      5,
      7700,
      10699,
      34758,
      92,
      5,
      30619,
      31431,
      10779,
      16,
      12095,
      16,
      5,
      30619,
      39470,
      82,
      28,
      39,
      3535,
      14418,
      62,
      41359,
      11,
      39,
      3535,
      14418,
      62,
      20608,
      5,
      10459,
      28,
      23683,
      4261,
      30383,
      5,
      16366,
      28,
      17887,
      1
    ],
    "start_token": 211,
    "end_token": 349,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      29566,
      286,
      7097,
      14626,
      7007,
      284,
      21207,
      1366
    ],
    "label": "ml_signal",
    "reason": "Usage of external HTTP requests to fetch data"
  },
  {
    "line": 17,
    "text": "    start = \"2016-03-31\"",
    "annotation": "\u26a0\ufe0f SAST Risk (Low): No validation of the JSON response, which may lead to runtime errors if the response is not JSON",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      923,
      796,
      366,
      5304,
      12,
      3070,
      12,
      3132,
      1
    ],
    "start_token": 349,
    "end_token": 361,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      20535,
      2599,
      1400,
      21201,
      286,
      262,
      19449,
      2882,
      11,
      543,
      743,
      1085,
      284,
      19124,
      8563,
      611,
      262,
      2882,
      318,
      407,
      19449
    ],
    "label": "sast_risk",
    "severity": "Low",
    "reason": "No validation of the JSON response, which may lead to runtime errors if the response is not JSON"
  },
  {
    "line": 18,
    "text": "",
    "annotation": "\ud83e\udde0 ML Signal: Conversion of HTTP response to JSON format",
    "confidence": 0.5,
    "tokens": [],
    "start_token": 361,
    "end_token": 361,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      44101,
      286,
      14626,
      2882,
      284,
      19449,
      5794
    ],
    "label": "ml_signal",
    "reason": "Conversion of HTTP response to JSON format"
  },
  {
    "line": 23,
    "text": "    def run(self):",
    "annotation": "\ud83e\udde0 ML Signal: Usage of print statements for debugging or logging",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      825,
      1057,
      7,
      944,
      2599
    ],
    "start_token": 361,
    "end_token": 369,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      29566,
      286,
      3601,
      6299,
      329,
      28769,
      393,
      18931
    ],
    "label": "ml_signal",
    "reason": "Usage of print statements for debugging or logging"
  },
  {
    "line": 25,
    "text": "        pn = 1",
    "annotation": "\ud83e\udde0 ML Signal: Persisting state indicates a checkpoint or recovery mechanism",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      279,
      77,
      796,
      352
    ],
    "start_token": 369,
    "end_token": 380,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      9467,
      9665,
      1181,
      9217,
      257,
      26954,
      393,
      7628,
      9030
    ],
    "label": "ml_signal",
    "reason": "Persisting state indicates a checkpoint or recovery mechanism"
  },
  {
    "line": 38,
    "text": "                    pn = pn",
    "annotation": "\ud83e\udde0 ML Signal: Usage of print statements for debugging or logging",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      279,
      77,
      796,
      279,
      77
    ],
    "start_token": 380,
    "end_token": 404,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      29566,
      286,
      3601,
      6299,
      329,
      28769,
      393,
      18931
    ],
    "label": "ml_signal",
    "reason": "Usage of print statements for debugging or logging"
  },
  {
    "line": 41,
    "text": "                    pn = self.state[\"pn\"] + 1",
    "annotation": "\ud83e\udde0 ML Signal: Persisting state indicates a checkpoint or recovery mechanism",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      279,
      77,
      796,
      2116,
      13,
      5219,
      14692,
      21999,
      8973,
      1343,
      352
    ],
    "start_token": 404,
    "end_token": 434,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      9467,
      9665,
      1181,
      9217,
      257,
      26954,
      393,
      7628,
      9030
    ],
    "label": "ml_signal",
    "reason": "Persisting state indicates a checkpoint or recovery mechanism"
  },
  {
    "line": 41,
    "text": "                    pn = self.state[\"pn\"] + 1",
    "annotation": "\u26a0\ufe0f SAST Risk (Low): Direct execution of code without input validation",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      279,
      77,
      796,
      2116,
      13,
      5219,
      14692,
      21999,
      8973,
      1343,
      352
    ],
    "start_token": 434,
    "end_token": 464,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      20535,
      2599,
      4128,
      9706,
      286,
      2438,
      1231,
      5128,
      21201
    ],
    "label": "sast_risk",
    "severity": "Low",
    "reason": "Direct execution of code without input validation"
  },
  {
    "line": 41,
    "text": "                    pn = self.state[\"pn\"] + 1",
    "annotation": "\ud83e\udde0 ML Signal: Entry point for script execution",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      279,
      77,
      796,
      2116,
      13,
      5219,
      14692,
      21999,
      8973,
      1343,
      352
    ],
    "start_token": 464,
    "end_token": 494,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      21617,
      966,
      329,
      4226,
      9706
    ],
    "label": "ml_signal",
    "reason": "Entry point for script execution"
  },
  {
    "line": 41,
    "text": "                    pn = self.state[\"pn\"] + 1",
    "annotation": "\u2705 Best Practice: Define __all__ to explicitly declare public API of the module",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      279,
      77,
      796,
      2116,
      13,
      5219,
      14692,
      21999,
      8973,
      1343,
      352
    ],
    "start_token": 494,
    "end_token": 524,
    "annotation_tokens": [
      26486,
      227,
      6705,
      19939,
      25,
      2896,
      500,
      11593,
      439,
      834,
      284,
      11777,
      13627,
      1171,
      7824,
      286,
      262,
      8265
    ],
    "label": "best_practice",
    "reason": "Define __all__ to explicitly declare public API of the module"
  }
]