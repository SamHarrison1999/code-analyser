[
  {
    "line": 2,
    "text": "",
    "annotation": "\u26a0\ufe0f SAST Risk (Low): Importing from external modules without validation can introduce security risks if the module is compromised.",
    "confidence": 1.0,
    "tokens": [],
    "start_token": 0,
    "end_token": 0,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      20535,
      2599,
      17267,
      278,
      422,
      7097,
      13103,
      1231,
      21201,
      460,
      10400,
      2324,
      7476,
      611,
      262,
      8265,
      318,
      19066,
      13
    ],
    "label": "sast_risk",
    "severity": "Low",
    "reason": "Importing from external modules without validation can introduce security risks if the module is compromised."
  },
  {
    "line": 7,
    "text": "from zvt.domain import Stock, DragonAndTiger",
    "annotation": "\ud83e\udde0 ML Signal: JSON-like data structure could be used to train models for pattern recognition in trading data.",
    "confidence": 0.5,
    "tokens": [
      6738,
      1976,
      36540,
      13,
      27830,
      1330,
      10500,
      11,
      2851,
      1870,
      51,
      8254
    ],
    "start_token": 0,
    "end_token": 12,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      19449,
      12,
      2339,
      1366,
      4645,
      714,
      307,
      973,
      284,
      4512,
      4981,
      329,
      3912,
      9465,
      287,
      7313,
      1366,
      13
    ],
    "label": "ml_signal",
    "reason": "JSON-like data structure could be used to train models for pattern recognition in trading data."
  },
  {
    "line": 131,
    "text": "            \"OPERATEDEPT_NAME\": \"\u7533\u4e07\u5b8f\u6e90\u8bc1\u5238\u6709\u9650\u516c\u53f8\u5357\u5b81\u957f\u6e56\u8def\u8bc1\u5238\u8425\u4e1a\u90e8\",",
    "annotation": "\u2705 Best Practice: Class attributes are defined at the top for clarity and maintainability",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      366,
      31054,
      11617,
      8905,
      51,
      62,
      20608,
      1298,
      366,
      18796,
      111,
      10310,
      229,
      22522,
      237,
      162,
      118,
      238,
      46237,
      223,
      26344,
      116,
      17312,
      231,
      165,
      247,
      238,
      17739,
      105,
      20998,
      116,
      39355,
      245,
      22522,
      223,
      165,
      243,
      123,
      162,
      117,
      244,
      164,
      115,
      107,
      46237,
      223,
      26344,
      116,
      164,
      238,
      98,
      10310,
      21253,
      225,
      101,
      1600
    ],
    "start_token": 12,
    "end_token": 79,
    "annotation_tokens": [
      26486,
      227,
      6705,
      19939,
      25,
      5016,
      12608,
      389,
      5447,
      379,
      262,
      1353,
      329,
      16287,
      290,
      5529,
      1799
    ],
    "label": "best_practice",
    "reason": "Class attributes are defined at the top for clarity and maintainability"
  },
  {
    "line": 133,
    "text": "            \"SELL_AMT_REAL\": 11602,",
    "annotation": "\ud83e\udde0 ML Signal: Usage of a specific schema indicates a pattern for data structure",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      366,
      5188,
      3069,
      62,
      2390,
      51,
      62,
      2200,
      1847,
      1298,
      1367,
      31418,
      11
    ],
    "start_token": 79,
    "end_token": 103,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      29566,
      286,
      257,
      2176,
      32815,
      9217,
      257,
      3912,
      329,
      1366,
      4645
    ],
    "label": "ml_signal",
    "reason": "Usage of a specific schema indicates a pattern for data structure"
  },
  {
    "line": 135,
    "text": "            \"SELL_RATIO\": 0.003208336653,",
    "annotation": "\u2705 Best Practice: Consistent naming for provider attributes improves readability",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      366,
      5188,
      3069,
      62,
      49,
      1404,
      9399,
      1298,
      657,
      13,
      11245,
      21315,
      2091,
      2791,
      4310,
      11
    ],
    "start_token": 103,
    "end_token": 130,
    "annotation_tokens": [
      26486,
      227,
      6705,
      19939,
      25,
      3515,
      7609,
      19264,
      329,
      10131,
      12608,
      19575,
      1100,
      1799
    ],
    "label": "best_practice",
    "reason": "Consistent naming for provider attributes improves readability"
  },
  {
    "line": 137,
    "text": "        },",
    "annotation": "\ud83e\udde0 ML Signal: Usage of a specific schema indicates a pattern for data structure",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      8964
    ],
    "start_token": 130,
    "end_token": 138,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      29566,
      286,
      257,
      2176,
      32815,
      9217,
      257,
      3912,
      329,
      1366,
      4645
    ],
    "label": "ml_signal",
    "reason": "Usage of a specific schema indicates a pattern for data structure"
  },
  {
    "line": 145,
    "text": "",
    "annotation": "\ud83e\udde0 ML Signal: Usage of entity attributes to create unique identifiers",
    "confidence": 0.5,
    "tokens": [],
    "start_token": 138,
    "end_token": 138,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      29566,
      286,
      9312,
      12608,
      284,
      2251,
      3748,
      42814
    ],
    "label": "ml_signal",
    "reason": "Usage of entity attributes to create unique identifiers"
  },
  {
    "line": 167,
    "text": "                    \"change_pct\": data[\"CHANGE_RATE\"],",
    "annotation": "\u26a0\ufe0f SAST Risk (Low): Potential division by zero if SELL_RATIO is zero",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      366,
      3803,
      62,
      79,
      310,
      1298,
      1366,
      14692,
      3398,
      27746,
      62,
      49,
      6158,
      33116
    ],
    "start_token": 138,
    "end_token": 171,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      20535,
      2599,
      32480,
      7297,
      416,
      6632,
      611,
      7946,
      3069,
      62,
      49,
      1404,
      9399,
      318,
      6632
    ],
    "label": "sast_risk",
    "severity": "Low",
    "reason": "Potential division by zero if SELL_RATIO is zero"
  },
  {
    "line": 174,
    "text": "                    flag = \"\" if dep[\"TRADE_DIRECTION\"] == \"0\" else \"_\"",
    "annotation": "\u2705 Best Practice: Ensure df_to_db handles exceptions to prevent data loss",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      6056,
      796,
      13538,
      611,
      1207,
      14692,
      5446,
      19266,
      62,
      17931,
      23988,
      2849,
      8973,
      6624,
      366,
      15,
      1,
      2073,
      45434,
      1
    ],
    "start_token": 171,
    "end_token": 210,
    "annotation_tokens": [
      26486,
      227,
      6705,
      19939,
      25,
      48987,
      47764,
      62,
      1462,
      62,
      9945,
      17105,
      13269,
      284,
      2948,
      1366,
      2994
    ],
    "label": "best_practice",
    "reason": "Ensure df_to_db handles exceptions to prevent data loss"
  },
  {
    "line": 177,
    "text": "                    dep_in = f\"{dep_name}_in\"",
    "annotation": "\u2705 Best Practice: Use logging to track when no data is available",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      1207,
      62,
      259,
      796,
      277,
      1,
      90,
      10378,
      62,
      3672,
      92,
      62,
      259,
      1
    ],
    "start_token": 210,
    "end_token": 243,
    "annotation_tokens": [
      26486,
      227,
      6705,
      19939,
      25,
      5765,
      18931,
      284,
      2610,
      618,
      645,
      1366,
      318,
      1695
    ],
    "label": "best_practice",
    "reason": "Use logging to track when no data is available"
  },
  {
    "line": 177,
    "text": "                    dep_in = f\"{dep_name}_in\"",
    "annotation": "\ud83e\udde0 ML Signal: Example of running a specific recorder with parameters",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      1207,
      62,
      259,
      796,
      277,
      1,
      90,
      10378,
      62,
      3672,
      92,
      62,
      259,
      1
    ],
    "start_token": 243,
    "end_token": 276,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      17934,
      286,
      2491,
      257,
      2176,
      38156,
      351,
      10007
    ],
    "label": "ml_signal",
    "reason": "Example of running a specific recorder with parameters"
  },
  {
    "line": 177,
    "text": "                    dep_in = f\"{dep_name}_in\"",
    "annotation": "\ud83e\udde0 ML Signal: Explicitly defining public API of the module",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      1207,
      62,
      259,
      796,
      277,
      1,
      90,
      10378,
      62,
      3672,
      92,
      62,
      259,
      1
    ],
    "start_token": 276,
    "end_token": 309,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      11884,
      306,
      16215,
      1171,
      7824,
      286,
      262,
      8265
    ],
    "label": "ml_signal",
    "reason": "Explicitly defining public API of the module"
  }
]