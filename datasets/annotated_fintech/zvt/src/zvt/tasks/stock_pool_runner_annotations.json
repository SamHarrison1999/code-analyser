[
  {
    "line": 24,
    "text": "from zvt.utils.recorder_utils import run_data_recorder",
    "annotation": "\u2705 Best Practice: Use of a background scheduler for periodic tasks",
    "confidence": 0.5,
    "tokens": [
      6738,
      1976,
      36540,
      13,
      26791,
      13,
      8344,
      2875,
      62,
      26791,
      1330,
      1057,
      62,
      7890,
      62,
      8344,
      2875
    ],
    "start_token": 0,
    "end_token": 17,
    "annotation_tokens": [
      26486,
      227,
      6705,
      19939,
      25,
      5765,
      286,
      257,
      4469,
      6038,
      18173,
      329,
      27458,
      8861
    ],
    "label": "best_practice",
    "reason": "Use of a background scheduler for periodic tasks"
  },
  {
    "line": 26,
    "text": "",
    "annotation": "\ud83e\udde0 ML Signal: Instantiation of an EmailInformer object indicates email notifications are used",
    "confidence": 1.0,
    "tokens": [],
    "start_token": 17,
    "end_token": 17,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      24470,
      3920,
      286,
      281,
      9570,
      818,
      16354,
      2134,
      9217,
      3053,
      19605,
      389,
      973
    ],
    "label": "ml_signal",
    "reason": "Instantiation of an EmailInformer object indicates email notifications are used"
  },
  {
    "line": 26,
    "text": "",
    "annotation": "\ud83e\udde0 ML Signal: Function definition with a specific task name, useful for identifying task-specific code patterns",
    "confidence": 1.0,
    "tokens": [],
    "start_token": 17,
    "end_token": 17,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      15553,
      6770,
      351,
      257,
      2176,
      4876,
      1438,
      11,
      4465,
      329,
      13720,
      4876,
      12,
      11423,
      2438,
      7572
    ],
    "label": "ml_signal",
    "reason": "Function definition with a specific task name, useful for identifying task-specific code patterns"
  },
  {
    "line": 28,
    "text": "",
    "annotation": "\ud83e\udde0 ML Signal: Querying data with specific order and limit, common pattern in data retrieval",
    "confidence": 1.0,
    "tokens": [],
    "start_token": 17,
    "end_token": 17,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      2264,
      263,
      1112,
      1366,
      351,
      2176,
      1502,
      290,
      4179,
      11,
      2219,
      3912,
      287,
      1366,
      45069
    ],
    "label": "ml_signal",
    "reason": "Querying data with specific order and limit, common pattern in data retrieval"
  },
  {
    "line": 30,
    "text": "",
    "annotation": "\ud83e\udde0 ML Signal: Accessing the first element of a list, common pattern for retrieving single data points",
    "confidence": 1.0,
    "tokens": [],
    "start_token": 17,
    "end_token": 17,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      8798,
      278,
      262,
      717,
      5002,
      286,
      257,
      1351,
      11,
      2219,
      3912,
      329,
      50122,
      2060,
      1366,
      2173
    ],
    "label": "ml_signal",
    "reason": "Accessing the first element of a list, common pattern for retrieving single data points"
  },
  {
    "line": 32,
    "text": "",
    "annotation": "\ud83e\udde0 ML Signal: Querying data with specific time range and columns, common pattern in data retrieval",
    "confidence": 1.0,
    "tokens": [],
    "start_token": 17,
    "end_token": 17,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      2264,
      263,
      1112,
      1366,
      351,
      2176,
      640,
      2837,
      290,
      15180,
      11,
      2219,
      3912,
      287,
      1366,
      45069
    ],
    "label": "ml_signal",
    "reason": "Querying data with specific time range and columns, common pattern in data retrieval"
  },
  {
    "line": 34,
    "text": "def report_limit_up():",
    "annotation": "\ud83e\udde0 ML Signal: String manipulation on DataFrame columns, common pattern in data processing",
    "confidence": 1.0,
    "tokens": [
      4299,
      989,
      62,
      32374,
      62,
      929,
      33529
    ],
    "start_token": 17,
    "end_token": 24,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      10903,
      17512,
      319,
      6060,
      19778,
      15180,
      11,
      2219,
      3912,
      287,
      1366,
      7587
    ],
    "label": "ml_signal",
    "reason": "String manipulation on DataFrame columns, common pattern in data processing"
  },
  {
    "line": 36,
    "text": "    timestamp = latest_data[0].timestamp",
    "annotation": "\u26a0\ufe0f SAST Risk (Low): Printing data directly, could lead to information disclosure in logs",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      41033,
      796,
      3452,
      62,
      7890,
      58,
      15,
      4083,
      16514,
      27823
    ],
    "start_token": 24,
    "end_token": 37,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      20535,
      2599,
      44118,
      1366,
      3264,
      11,
      714,
      1085,
      284,
      1321,
      13019,
      287,
      17259
    ],
    "label": "sast_risk",
    "severity": "Low",
    "reason": "Printing data directly, could lead to information disclosure in logs"
  },
  {
    "line": 37,
    "text": "    df = LimitUpInfo.query_data(start_timestamp=timestamp, end_timestamp=timestamp, columns=[\"code\", \"name\", \"reason\"])",
    "annotation": "\u26a0\ufe0f SAST Risk (Medium): Sending emails with potentially sensitive data, ensure secure handling of email credentials",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      47764,
      796,
      27272,
      4933,
      12360,
      13,
      22766,
      62,
      7890,
      7,
      9688,
      62,
      16514,
      27823,
      28,
      16514,
      27823,
      11,
      886,
      62,
      16514,
      27823,
      28,
      16514,
      27823,
      11,
      15180,
      28,
      14692,
      8189,
      1600,
      366,
      3672,
      1600,
      366,
      41181,
      8973,
      8
    ],
    "start_token": 37,
    "end_token": 78,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      31205,
      2599,
      32038,
      7237,
      351,
      6196,
      8564,
      1366,
      11,
      4155,
      5713,
      9041,
      286,
      3053,
      18031
    ],
    "label": "sast_risk",
    "severity": "Medium",
    "reason": "Sending emails with potentially sensitive data, ensure secure handling of email credentials"
  },
  {
    "line": 34,
    "text": "def report_limit_up():",
    "annotation": "\ud83e\udde0 ML Signal: Default parameter values indicate common usage patterns",
    "confidence": 1.0,
    "tokens": [
      4299,
      989,
      62,
      32374,
      62,
      929,
      33529
    ],
    "start_token": 78,
    "end_token": 85,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      15161,
      11507,
      3815,
      7603,
      2219,
      8748,
      7572
    ],
    "label": "ml_signal",
    "reason": "Default parameter values indicate common usage patterns"
  },
  {
    "line": 36,
    "text": "    timestamp = latest_data[0].timestamp",
    "annotation": "\u26a0\ufe0f SAST Risk (Low): Lack of error handling for report_limit_up function",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      41033,
      796,
      3452,
      62,
      7890,
      58,
      15,
      4083,
      16514,
      27823
    ],
    "start_token": 85,
    "end_token": 98,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      20535,
      2599,
      38289,
      286,
      4049,
      9041,
      329,
      989,
      62,
      32374,
      62,
      929,
      2163
    ],
    "label": "sast_risk",
    "severity": "Low",
    "reason": "Lack of error handling for report_limit_up function"
  },
  {
    "line": 52,
    "text": "        domain=Index1dKdata,",
    "annotation": "\u26a0\ufe0f SAST Risk (Low): Potential SQL injection risk if Block.query_data is not properly sanitized",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      7386,
      28,
      15732,
      16,
      67,
      42,
      7890,
      11
    ],
    "start_token": 98,
    "end_token": 113,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      20535,
      2599,
      32480,
      16363,
      16954,
      2526,
      611,
      9726,
      13,
      22766,
      62,
      7890,
      318,
      407,
      6105,
      5336,
      36951
    ],
    "label": "sast_risk",
    "severity": "Low",
    "reason": "Potential SQL injection risk if Block.query_data is not properly sanitized"
  },
  {
    "line": 61,
    "text": "    # \u677f\u5757\u884c\u60c5(\u6982\u5ff5\uff0c\u884c\u4e1a)",
    "annotation": "\u26a0\ufe0f SAST Risk (Low): Lack of error handling for inform_email function",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      1303,
      10545,
      251,
      123,
      161,
      251,
      245,
      26193,
      234,
      46349,
      227,
      7,
      162,
      99,
      224,
      33232,
      113,
      171,
      120,
      234,
      26193,
      234,
      10310,
      248,
      8
    ],
    "start_token": 113,
    "end_token": 141,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      20535,
      2599,
      38289,
      286,
      4049,
      9041,
      329,
      4175,
      62,
      12888,
      2163
    ],
    "label": "sast_risk",
    "severity": "Low",
    "reason": "Lack of error handling for inform_email function"
  },
  {
    "line": 65,
    "text": "        data_provider=entity_provider,",
    "annotation": "\u26a0\ufe0f SAST Risk (Low): Lack of error handling for get_entity_ids_by_filter function",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      1366,
      62,
      15234,
      1304,
      28,
      26858,
      62,
      15234,
      1304,
      11
    ],
    "start_token": 141,
    "end_token": 158,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      20535,
      2599,
      38289,
      286,
      4049,
      9041,
      329,
      651,
      62,
      26858,
      62,
      2340,
      62,
      1525,
      62,
      24455,
      2163
    ],
    "label": "sast_risk",
    "severity": "Low",
    "reason": "Lack of error handling for get_entity_ids_by_filter function"
  },
  {
    "line": 74,
    "text": "        index=\"entity_id\",",
    "annotation": "\ud83e\udde0 ML Signal: Function with default parameters indicating common usage patterns",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      6376,
      2625,
      26858,
      62,
      312,
      1600
    ],
    "start_token": 158,
    "end_token": 171,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      15553,
      351,
      4277,
      10007,
      12739,
      2219,
      8748,
      7572
    ],
    "label": "ml_signal",
    "reason": "Function with default parameters indicating common usage patterns"
  },
  {
    "line": 76,
    "text": "    )",
    "annotation": "\ud83e\udde0 ML Signal: Function call with specific domain indicating a pattern of data recording",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      1267
    ],
    "start_token": 171,
    "end_token": 175,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      15553,
      869,
      351,
      2176,
      7386,
      12739,
      257,
      3912,
      286,
      1366,
      8296
    ],
    "label": "ml_signal",
    "reason": "Function call with specific domain indicating a pattern of data recording"
  },
  {
    "line": 77,
    "text": "",
    "annotation": "\ud83e\udde0 ML Signal: Querying data with specific filters indicating a pattern of data access",
    "confidence": 1.0,
    "tokens": [],
    "start_token": 175,
    "end_token": 175,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      2264,
      263,
      1112,
      1366,
      351,
      2176,
      16628,
      12739,
      257,
      3912,
      286,
      1366,
      1895
    ],
    "label": "ml_signal",
    "reason": "Querying data with specific filters indicating a pattern of data access"
  },
  {
    "line": 77,
    "text": "",
    "annotation": "\ud83e\udde0 ML Signal: Function call with multiple parameters indicating a pattern of data processing",
    "confidence": 1.0,
    "tokens": [],
    "start_token": 175,
    "end_token": 175,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      15553,
      869,
      351,
      3294,
      10007,
      12739,
      257,
      3912,
      286,
      1366,
      7587
    ],
    "label": "ml_signal",
    "reason": "Function call with multiple parameters indicating a pattern of data processing"
  },
  {
    "line": 86,
    "text": "        provider=\"em\", ignore_delist=True, ignore_st=False, ignore_new_stock=False",
    "annotation": "\ud83e\udde0 ML Signal: Function calls that indicate a sequence of operations for data processing",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      10131,
      2625,
      368,
      1600,
      8856,
      62,
      12381,
      396,
      28,
      17821,
      11,
      8856,
      62,
      301,
      28,
      25101,
      11,
      8856,
      62,
      3605,
      62,
      13578,
      28,
      25101
    ],
    "start_token": 175,
    "end_token": 206,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      15553,
      3848,
      326,
      7603,
      257,
      8379,
      286,
      4560,
      329,
      1366,
      7587
    ],
    "label": "ml_signal",
    "reason": "Function calls that indicate a sequence of operations for data processing"
  },
  {
    "line": 88,
    "text": "",
    "annotation": "\ud83e\udde0 ML Signal: Function calls that indicate a sequence of operations for data processing",
    "confidence": 0.5,
    "tokens": [],
    "start_token": 206,
    "end_token": 206,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      15553,
      3848,
      326,
      7603,
      257,
      8379,
      286,
      4560,
      329,
      1366,
      7587
    ],
    "label": "ml_signal",
    "reason": "Function calls that indicate a sequence of operations for data processing"
  },
  {
    "line": 90,
    "text": "        entity_ids=normal_stock_ids,",
    "annotation": "\ud83e\udde0 ML Signal: Function calls that indicate a sequence of operations for data processing",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      9312,
      62,
      2340,
      28,
      11265,
      62,
      13578,
      62,
      2340,
      11
    ],
    "start_token": 206,
    "end_token": 223,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      15553,
      3848,
      326,
      7603,
      257,
      8379,
      286,
      4560,
      329,
      1366,
      7587
    ],
    "label": "ml_signal",
    "reason": "Function calls that indicate a sequence of operations for data processing"
  },
  {
    "line": 92,
    "text": "        data_provider=data_provider,",
    "annotation": "\ud83e\udde0 ML Signal: Iterating over a list of stock pool names for processing",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      1366,
      62,
      15234,
      1304,
      28,
      7890,
      62,
      15234,
      1304,
      11
    ],
    "start_token": 223,
    "end_token": 240,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      40806,
      803,
      625,
      257,
      1351,
      286,
      4283,
      5933,
      3891,
      329,
      7587
    ],
    "label": "ml_signal",
    "reason": "Iterating over a list of stock pool names for processing"
  },
  {
    "line": 94,
    "text": "        day_data=True,",
    "annotation": "\ud83e\udde0 ML Signal: Function call with parameters that might affect data processing",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      1110,
      62,
      7890,
      28,
      17821,
      11
    ],
    "start_token": 240,
    "end_token": 253,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      15553,
      869,
      351,
      10007,
      326,
      1244,
      2689,
      1366,
      7587
    ],
    "label": "ml_signal",
    "reason": "Function call with parameters that might affect data processing"
  },
  {
    "line": 96,
    "text": "        return_unfinished=True,",
    "annotation": "\u2705 Best Practice: Initializing logging for the application",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      1441,
      62,
      403,
      43952,
      28,
      17821,
      11
    ],
    "start_token": 253,
    "end_token": 267,
    "annotation_tokens": [
      26486,
      227,
      6705,
      19939,
      25,
      20768,
      2890,
      18931,
      329,
      262,
      3586
    ],
    "label": "best_practice",
    "reason": "Initializing logging for the application"
  },
  {
    "line": 96,
    "text": "        return_unfinished=True,",
    "annotation": "\ud83e\udde0 ML Signal: Function call to initiate a sequence of operations",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      1441,
      62,
      403,
      43952,
      28,
      17821,
      11
    ],
    "start_token": 267,
    "end_token": 281,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      15553,
      869,
      284,
      22118,
      257,
      8379,
      286,
      4560
    ],
    "label": "ml_signal",
    "reason": "Function call to initiate a sequence of operations"
  },
  {
    "line": 96,
    "text": "        return_unfinished=True,",
    "annotation": "\u26a0\ufe0f SAST Risk (Low): Potential misconfiguration in cron job scheduling",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      1441,
      62,
      403,
      43952,
      28,
      17821,
      11
    ],
    "start_token": 281,
    "end_token": 295,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      20535,
      2599,
      32480,
      2984,
      11250,
      3924,
      287,
      1067,
      261,
      1693,
      26925
    ],
    "label": "sast_risk",
    "severity": "Low",
    "reason": "Potential misconfiguration in cron job scheduling"
  },
  {
    "line": 96,
    "text": "        return_unfinished=True,",
    "annotation": "\ud83e\udde0 ML Signal: Starting a scheduler for periodic task execution",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      1441,
      62,
      403,
      43952,
      28,
      17821,
      11
    ],
    "start_token": 295,
    "end_token": 309,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      17962,
      257,
      6038,
      18173,
      329,
      27458,
      4876,
      9706
    ],
    "label": "ml_signal",
    "reason": "Starting a scheduler for periodic task execution"
  },
  {
    "line": 96,
    "text": "        return_unfinished=True,",
    "annotation": "\u26a0\ufe0f SAST Risk (Low): Direct access to a protected member of an object",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      1441,
      62,
      403,
      43952,
      28,
      17821,
      11
    ],
    "start_token": 309,
    "end_token": 323,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      20535,
      2599,
      4128,
      1895,
      284,
      257,
      6861,
      2888,
      286,
      281,
      2134
    ],
    "label": "sast_risk",
    "severity": "Low",
    "reason": "Direct access to a protected member of an object"
  }
]