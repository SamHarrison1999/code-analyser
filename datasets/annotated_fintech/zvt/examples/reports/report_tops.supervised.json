[
  {
    "line": 11,
    "text": "from zvt.factors.top_stocks import get_top_stocks",
    "annotation": "\ud83e\udde0 ML Signal: Usage of logging for tracking and debugging",
    "confidence": 1.0,
    "tokens": [
      6738,
      1976,
      36540,
      13,
      22584,
      669,
      13,
      4852,
      62,
      29522,
      1330,
      651,
      62,
      4852,
      62,
      29522
    ],
    "start_token": 0,
    "end_token": 16,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      29566,
      286,
      18931,
      329,
      9646,
      290,
      28769
    ],
    "label": "ml_signal",
    "reason": "Usage of logging for tracking and debugging"
  },
  {
    "line": 14,
    "text": "logger = logging.getLogger(__name__)",
    "annotation": "\ud83e\udde0 ML Signal: Usage of a background scheduler for periodic tasks",
    "confidence": 1.0,
    "tokens": [
      6404,
      1362,
      796,
      18931,
      13,
      1136,
      11187,
      1362,
      7,
      834,
      3672,
      834,
      8
    ],
    "start_token": 16,
    "end_token": 29,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      29566,
      286,
      257,
      4469,
      6038,
      18173,
      329,
      27458,
      8861
    ],
    "label": "ml_signal",
    "reason": "Usage of a background scheduler for periodic tasks"
  },
  {
    "line": 17,
    "text": "",
    "annotation": "\ud83e\udde0 ML Signal: Usage of an email informer for notifications",
    "confidence": 1.0,
    "tokens": [],
    "start_token": 29,
    "end_token": 29,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      29566,
      286,
      281,
      3053,
      4175,
      263,
      329,
      19605
    ],
    "label": "ml_signal",
    "reason": "Usage of an email informer for notifications"
  },
  {
    "line": 19,
    "text": "",
    "annotation": "\ud83e\udde0 ML Signal: Scheduled job pattern for periodic execution",
    "confidence": 1.0,
    "tokens": [],
    "start_token": 29,
    "end_token": 29,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      27774,
      6309,
      1693,
      3912,
      329,
      27458,
      9706
    ],
    "label": "ml_signal",
    "reason": "Scheduled job pattern for periodic execution"
  },
  {
    "line": 19,
    "text": "",
    "annotation": "\u26a0\ufe0f SAST Risk (Low): Cron jobs can lead to unexpected behavior if not properly managed",
    "confidence": 1.0,
    "tokens": [],
    "start_token": 29,
    "end_token": 29,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      20535,
      2599,
      31683,
      3946,
      460,
      1085,
      284,
      10059,
      4069,
      611,
      407,
      6105,
      5257
    ],
    "label": "sast_risk",
    "severity": "Low",
    "reason": "Cron jobs can lead to unexpected behavior if not properly managed"
  },
  {
    "line": 17,
    "text": "",
    "annotation": "\ud83e\udde0 ML Signal: Usage of a specific provider and entity type for fetching data",
    "confidence": 1.0,
    "tokens": [],
    "start_token": 29,
    "end_token": 29,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      29566,
      286,
      257,
      2176,
      10131,
      290,
      9312,
      2099,
      329,
      21207,
      278,
      1366
    ],
    "label": "ml_signal",
    "reason": "Usage of a specific provider and entity type for fetching data"
  },
  {
    "line": 19,
    "text": "",
    "annotation": "\ud83e\udde0 ML Signal: Fetching top stocks based on a specific date and return type",
    "confidence": 0.5,
    "tokens": [],
    "start_token": 29,
    "end_token": 29,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      376,
      7569,
      278,
      1353,
      14420,
      1912,
      319,
      257,
      2176,
      3128,
      290,
      1441,
      2099
    ],
    "label": "ml_signal",
    "reason": "Fetching top stocks based on a specific date and return type"
  },
  {
    "line": 19,
    "text": "",
    "annotation": "\u26a0\ufe0f SAST Risk (Low): Potential exposure of sensitive data through email",
    "confidence": 1.0,
    "tokens": [],
    "start_token": 29,
    "end_token": 29,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      20535,
      2599,
      32480,
      7111,
      286,
      8564,
      1366,
      832,
      3053
    ],
    "label": "sast_risk",
    "severity": "Low",
    "reason": "Potential exposure of sensitive data through email"
  },
  {
    "line": 30,
    "text": "        email_informer,",
    "annotation": "\ud83e\udde0 ML Signal: Dynamic generation of email titles based on stock data",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      3053,
      62,
      259,
      16354,
      11
    ],
    "start_token": 29,
    "end_token": 41,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      26977,
      5270,
      286,
      3053,
      8714,
      1912,
      319,
      4283,
      1366
    ],
    "label": "ml_signal",
    "reason": "Dynamic generation of email titles based on stock data"
  },
  {
    "line": 31,
    "text": "        entity_ids=selected,",
    "annotation": "\ud83e\udde0 ML Signal: Repeated pattern for fetching and informing about top stocks",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      9312,
      62,
      2340,
      28,
      34213,
      11
    ],
    "start_token": 41,
    "end_token": 54,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      30558,
      515,
      3912,
      329,
      21207,
      278,
      290,
      29140,
      546,
      1353,
      14420
    ],
    "label": "ml_signal",
    "reason": "Repeated pattern for fetching and informing about top stocks"
  },
  {
    "line": 31,
    "text": "        entity_ids=selected,",
    "annotation": "\u26a0\ufe0f SAST Risk (Low): Potential exposure of sensitive data through email",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      9312,
      62,
      2340,
      28,
      34213,
      11
    ],
    "start_token": 54,
    "end_token": 67,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      20535,
      2599,
      32480,
      7111,
      286,
      8564,
      1366,
      832,
      3053
    ],
    "label": "sast_risk",
    "severity": "Low",
    "reason": "Potential exposure of sensitive data through email"
  },
  {
    "line": 41,
    "text": "",
    "annotation": "\ud83e\udde0 ML Signal: Dynamic generation of email titles based on stock data",
    "confidence": 0.5,
    "tokens": [],
    "start_token": 67,
    "end_token": 67,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      26977,
      5270,
      286,
      3053,
      8714,
      1912,
      319,
      4283,
      1366
    ],
    "label": "ml_signal",
    "reason": "Dynamic generation of email titles based on stock data"
  },
  {
    "line": 46,
    "text": "        title=f\"stock \u4e2d\u671f\u6700\u5f3a({len(selected)})\",",
    "annotation": "\u2705 Best Practice: Use of a scheduled job for periodic task execution",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      3670,
      28,
      69,
      1,
      13578,
      220,
      40792,
      17312,
      253,
      17312,
      222,
      28156,
      118,
      15090,
      11925,
      7,
      34213,
      8,
      30072,
      1600
    ],
    "start_token": 67,
    "end_token": 94,
    "annotation_tokens": [
      26486,
      227,
      6705,
      19939,
      25,
      5765,
      286,
      257,
      7530,
      1693,
      329,
      27458,
      4876,
      9706
    ],
    "label": "best_practice",
    "reason": "Use of a scheduled job for periodic task execution"
  },
  {
    "line": 44,
    "text": "        entity_ids=selected,",
    "annotation": "\ud83e\udde0 ML Signal: Usage of query_data method to filter and retrieve data",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      9312,
      62,
      2340,
      28,
      34213,
      11
    ],
    "start_token": 94,
    "end_token": 107,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      29566,
      286,
      12405,
      62,
      7890,
      2446,
      284,
      8106,
      290,
      19818,
      1366
    ],
    "label": "ml_signal",
    "reason": "Usage of query_data method to filter and retrieve data"
  },
  {
    "line": 46,
    "text": "        title=f\"stock \u4e2d\u671f\u6700\u5f3a({len(selected)})\",",
    "annotation": "\ud83e\udde0 ML Signal: Conversion of DataFrame index to list",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      3670,
      28,
      69,
      1,
      13578,
      220,
      40792,
      17312,
      253,
      17312,
      222,
      28156,
      118,
      15090,
      11925,
      7,
      34213,
      8,
      30072,
      1600
    ],
    "start_token": 107,
    "end_token": 134,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      44101,
      286,
      6060,
      19778,
      6376,
      284,
      1351
    ],
    "label": "ml_signal",
    "reason": "Conversion of DataFrame index to list"
  },
  {
    "line": 46,
    "text": "        title=f\"stock \u4e2d\u671f\u6700\u5f3a({len(selected)})\",",
    "annotation": "\ud83e\udde0 ML Signal: Usage of report_top_entities function with specific parameters",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      3670,
      28,
      69,
      1,
      13578,
      220,
      40792,
      17312,
      253,
      17312,
      222,
      28156,
      118,
      15090,
      11925,
      7,
      34213,
      8,
      30072,
      1600
    ],
    "start_token": 134,
    "end_token": 161,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      29566,
      286,
      989,
      62,
      4852,
      62,
      298,
      871,
      2163,
      351,
      2176,
      10007
    ],
    "label": "ml_signal",
    "reason": "Usage of report_top_entities function with specific parameters"
  },
  {
    "line": 67,
    "text": "    #     em_group_over_write=True,",
    "annotation": "\ud83e\udde0 ML Signal: Usage of query_data method to filter and retrieve data",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      1303,
      220,
      220,
      220,
      220,
      795,
      62,
      8094,
      62,
      2502,
      62,
      13564,
      28,
      17821,
      11
    ],
    "start_token": 161,
    "end_token": 179,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      29566,
      286,
      12405,
      62,
      7890,
      2446,
      284,
      8106,
      290,
      19818,
      1366
    ],
    "label": "ml_signal",
    "reason": "Usage of query_data method to filter and retrieve data"
  },
  {
    "line": 67,
    "text": "    #     em_group_over_write=True,",
    "annotation": "\ud83e\udde0 ML Signal: Filtering DataFrame based on string content",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      1303,
      220,
      220,
      220,
      220,
      795,
      62,
      8094,
      62,
      2502,
      62,
      13564,
      28,
      17821,
      11
    ],
    "start_token": 179,
    "end_token": 197,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      7066,
      20212,
      6060,
      19778,
      1912,
      319,
      4731,
      2695
    ],
    "label": "ml_signal",
    "reason": "Filtering DataFrame based on string content"
  },
  {
    "line": 67,
    "text": "    #     em_group_over_write=True,",
    "annotation": "\ud83e\udde0 ML Signal: Conversion of DataFrame index to list",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      1303,
      220,
      220,
      220,
      220,
      795,
      62,
      8094,
      62,
      2502,
      62,
      13564,
      28,
      17821,
      11
    ],
    "start_token": 197,
    "end_token": 215,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      44101,
      286,
      6060,
      19778,
      6376,
      284,
      1351
    ],
    "label": "ml_signal",
    "reason": "Conversion of DataFrame index to list"
  },
  {
    "line": 67,
    "text": "    #     em_group_over_write=True,",
    "annotation": "\ud83e\udde0 ML Signal: Usage of report_top_entities function with specific parameters",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      1303,
      220,
      220,
      220,
      220,
      795,
      62,
      8094,
      62,
      2502,
      62,
      13564,
      28,
      17821,
      11
    ],
    "start_token": 215,
    "end_token": 233,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      29566,
      286,
      989,
      62,
      4852,
      62,
      298,
      871,
      2163,
      351,
      2176,
      10007
    ],
    "label": "ml_signal",
    "reason": "Usage of report_top_entities function with specific parameters"
  },
  {
    "line": 87,
    "text": "        turnover_rate_threshold=0,",
    "annotation": "\u26a0\ufe0f SAST Risk (Low): Scheduled job may expose sensitive data if not properly secured",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      25079,
      62,
      4873,
      62,
      400,
      10126,
      28,
      15,
      11
    ],
    "start_token": 233,
    "end_token": 249,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      20535,
      2599,
      27774,
      6309,
      1693,
      743,
      15651,
      8564,
      1366,
      611,
      407,
      6105,
      13659
    ],
    "label": "sast_risk",
    "severity": "Low",
    "reason": "Scheduled job may expose sensitive data if not properly secured"
  },
  {
    "line": 87,
    "text": "        turnover_rate_threshold=0,",
    "annotation": "\ud83e\udde0 ML Signal: Function call with specific parameters indicating a pattern of usage",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      25079,
      62,
      4873,
      62,
      400,
      10126,
      28,
      15,
      11
    ],
    "start_token": 249,
    "end_token": 265,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      15553,
      869,
      351,
      2176,
      10007,
      12739,
      257,
      3912,
      286,
      8748
    ],
    "label": "ml_signal",
    "reason": "Function call with specific parameters indicating a pattern of usage"
  },
  {
    "line": 104,
    "text": "        ignore_new_stock=False,",
    "annotation": "\ud83e\udde0 ML Signal: Function call with specific parameters indicating a pattern of usage",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      8856,
      62,
      3605,
      62,
      13578,
      28,
      25101,
      11
    ],
    "start_token": 265,
    "end_token": 280,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      15553,
      869,
      351,
      2176,
      10007,
      12739,
      257,
      3912,
      286,
      8748
    ],
    "label": "ml_signal",
    "reason": "Function call with specific parameters indicating a pattern of usage"
  },
  {
    "line": 124,
    "text": "        data_provider=\"em\",",
    "annotation": "\u2705 Best Practice: Logging initialization for better traceability and debugging",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      1366,
      62,
      15234,
      1304,
      2625,
      368,
      1600
    ],
    "start_token": 280,
    "end_token": 294,
    "annotation_tokens": [
      26486,
      227,
      6705,
      19939,
      25,
      5972,
      2667,
      37588,
      329,
      1365,
      12854,
      1799,
      290,
      28769
    ],
    "label": "best_practice",
    "reason": "Logging initialization for better traceability and debugging"
  },
  {
    "line": 126,
    "text": "        periods=[*range(1, 15)],",
    "annotation": "\u26a0\ufe0f SAST Risk (Low): Potential typo or undefined function 'report_top_stocks'",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      9574,
      41888,
      9,
      9521,
      7,
      16,
      11,
      1315,
      8,
      4357
    ],
    "start_token": 294,
    "end_token": 311,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      20535,
      2599,
      32480,
      46517,
      393,
      28721,
      2163,
      705,
      13116,
      62,
      4852,
      62,
      29522,
      6
    ],
    "label": "sast_risk",
    "severity": "Low",
    "reason": "Potential typo or undefined function 'report_top_stocks'"
  },
  {
    "line": 126,
    "text": "        periods=[*range(1, 15)],",
    "annotation": "\ud83e\udde0 ML Signal: Function call indicating a pattern of usage",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      9574,
      41888,
      9,
      9521,
      7,
      16,
      11,
      1315,
      8,
      4357
    ],
    "start_token": 311,
    "end_token": 328,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      15553,
      869,
      12739,
      257,
      3912,
      286,
      8748
    ],
    "label": "ml_signal",
    "reason": "Function call indicating a pattern of usage"
  },
  {
    "line": 126,
    "text": "        periods=[*range(1, 15)],",
    "annotation": "\ud83e\udde0 ML Signal: Scheduler start indicating a pattern of usage",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      9574,
      41888,
      9,
      9521,
      7,
      16,
      11,
      1315,
      8,
      4357
    ],
    "start_token": 328,
    "end_token": 345,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      27774,
      18173,
      923,
      12739,
      257,
      3912,
      286,
      8748
    ],
    "label": "ml_signal",
    "reason": "Scheduler start indicating a pattern of usage"
  },
  {
    "line": 126,
    "text": "        periods=[*range(1, 15)],",
    "annotation": "\u26a0\ufe0f SAST Risk (Low): Direct access to protected member '_thread' of a class",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      9574,
      41888,
      9,
      9521,
      7,
      16,
      11,
      1315,
      8,
      4357
    ],
    "start_token": 345,
    "end_token": 362,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      20535,
      2599,
      4128,
      1895,
      284,
      6861,
      2888,
      705,
      62,
      16663,
      6,
      286,
      257,
      1398
    ],
    "label": "sast_risk",
    "severity": "Low",
    "reason": "Direct access to protected member '_thread' of a class"
  }
]