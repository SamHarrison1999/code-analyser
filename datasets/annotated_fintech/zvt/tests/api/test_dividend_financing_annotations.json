[
  {
    "line": 3,
    "text": "init_test_context()",
    "annotation": "\u2705 Best Practice: Ensure the test context is initialized before importing other modules to avoid dependency issues.",
    "confidence": 0.5,
    "tokens": [
      15003,
      62,
      9288,
      62,
      22866,
      3419
    ],
    "start_token": 0,
    "end_token": 6,
    "annotation_tokens": [
      26486,
      227,
      6705,
      19939,
      25,
      48987,
      262,
      1332,
      4732,
      318,
      23224,
      878,
      33332,
      584,
      13103,
      284,
      3368,
      20203,
      2428,
      13
    ],
    "label": "best_practice",
    "reason": "Ensure the test context is initialized before importing other modules to avoid dependency issues."
  },
  {
    "line": 7,
    "text": "from zvt.utils.time_utils import to_pd_timestamp",
    "annotation": "\ud83e\udde0 ML Signal: Usage of a specific provider and database name can indicate user preferences or common configurations.",
    "confidence": 0.5,
    "tokens": [
      6738,
      1976,
      36540,
      13,
      26791,
      13,
      2435,
      62,
      26791,
      1330,
      284,
      62,
      30094,
      62,
      16514,
      27823
    ],
    "start_token": 6,
    "end_token": 22,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      29566,
      286,
      257,
      2176,
      10131,
      290,
      6831,
      1438,
      460,
      7603,
      2836,
      15387,
      393,
      2219,
      25412,
      13
    ],
    "label": "ml_signal",
    "reason": "Usage of a specific provider and database name can indicate user preferences or common configurations."
  },
  {
    "line": 7,
    "text": "from zvt.utils.time_utils import to_pd_timestamp",
    "annotation": "\ud83e\udde0 ML Signal: Function name pattern indicates a test function",
    "confidence": 1.0,
    "tokens": [
      6738,
      1976,
      36540,
      13,
      26791,
      13,
      2435,
      62,
      26791,
      1330,
      284,
      62,
      30094,
      62,
      16514,
      27823
    ],
    "start_token": 22,
    "end_token": 38,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      15553,
      1438,
      3912,
      9217,
      257,
      1332,
      2163
    ],
    "label": "ml_signal",
    "reason": "Function name pattern indicates a test function"
  },
  {
    "line": 8,
    "text": "",
    "annotation": "\ud83e\udde0 ML Signal: Querying data with specific parameters",
    "confidence": 1.0,
    "tokens": [],
    "start_token": 38,
    "end_token": 38,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      2264,
      263,
      1112,
      1366,
      351,
      2176,
      10007
    ],
    "label": "ml_signal",
    "reason": "Querying data with specific parameters"
  },
  {
    "line": 8,
    "text": "",
    "annotation": "\u26a0\ufe0f SAST Risk (Low): Potential exposure of sensitive data through query parameters",
    "confidence": 0.5,
    "tokens": [],
    "start_token": 38,
    "end_token": 38,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      20535,
      2599,
      32480,
      7111,
      286,
      8564,
      1366,
      832,
      12405,
      10007
    ],
    "label": "sast_risk",
    "severity": "Low",
    "reason": "Potential exposure of sensitive data through query parameters"
  },
  {
    "line": 8,
    "text": "",
    "annotation": "\ud83e\udde0 ML Signal: Use of session object for database operations",
    "confidence": 1.0,
    "tokens": [],
    "start_token": 38,
    "end_token": 38,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      5765,
      286,
      6246,
      2134,
      329,
      6831,
      4560
    ],
    "label": "ml_signal",
    "reason": "Use of session object for database operations"
  },
  {
    "line": 16,
    "text": "        provider=\"eastmoney\",",
    "annotation": "\ud83e\udde0 ML Signal: Hardcoded provider name",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      10131,
      2625,
      23316,
      26316,
      1600
    ],
    "start_token": 38,
    "end_token": 50,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      6912,
      40976,
      10131,
      1438
    ],
    "label": "ml_signal",
    "reason": "Hardcoded provider name"
  },
  {
    "line": 16,
    "text": "        provider=\"eastmoney\",",
    "annotation": "\ud83e\udde0 ML Signal: Specifying return type for query",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      10131,
      2625,
      23316,
      26316,
      1600
    ],
    "start_token": 50,
    "end_token": 62,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      18291,
      4035,
      1441,
      2099,
      329,
      12405
    ],
    "label": "ml_signal",
    "reason": "Specifying return type for query"
  },
  {
    "line": 18,
    "text": "        codes=[\"000778\"],",
    "annotation": "\ud83e\udde0 ML Signal: Querying with specific codes",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      12416,
      28,
      14692,
      830,
      39761,
      33116
    ],
    "start_token": 62,
    "end_token": 75,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      2264,
      263,
      1112,
      351,
      2176,
      12416
    ],
    "label": "ml_signal",
    "reason": "Querying with specific codes"
  },
  {
    "line": 20,
    "text": "        order=SpoDetail.timestamp.desc(),",
    "annotation": "\ud83e\udde0 ML Signal: Use of specific timestamp for data filtering",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      1502,
      28,
      4561,
      78,
      11242,
      603,
      13,
      16514,
      27823,
      13,
      20147,
      22784
    ],
    "start_token": 75,
    "end_token": 94,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      5765,
      286,
      2176,
      41033,
      329,
      1366,
      25431
    ],
    "label": "ml_signal",
    "reason": "Use of specific timestamp for data filtering"
  },
  {
    "line": 22,
    "text": "    assert len(result) == 4",
    "annotation": "\ud83e\udde0 ML Signal: Ordering query results by timestamp",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      6818,
      18896,
      7,
      20274,
      8,
      6624,
      604
    ],
    "start_token": 94,
    "end_token": 104,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      8284,
      278,
      12405,
      2482,
      416,
      41033
    ],
    "label": "ml_signal",
    "reason": "Ordering query results by timestamp"
  },
  {
    "line": 23,
    "text": "    latest: SpoDetail = result[0]",
    "annotation": "\ud83e\udde0 ML Signal: Assertion to check the length of the result",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      3452,
      25,
      49331,
      11242,
      603,
      796,
      1255,
      58,
      15,
      60
    ],
    "start_token": 104,
    "end_token": 117,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      2195,
      861,
      295,
      284,
      2198,
      262,
      4129,
      286,
      262,
      1255
    ],
    "label": "ml_signal",
    "reason": "Assertion to check the length of the result"
  },
  {
    "line": 23,
    "text": "    latest: SpoDetail = result[0]",
    "annotation": "\ud83e\udde0 ML Signal: Type hinting for variable",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      3452,
      25,
      49331,
      11242,
      603,
      796,
      1255,
      58,
      15,
      60
    ],
    "start_token": 117,
    "end_token": 130,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      5994,
      9254,
      278,
      329,
      7885
    ],
    "label": "ml_signal",
    "reason": "Type hinting for variable"
  },
  {
    "line": 31,
    "text": "def test_000778_rights_issue_detail():",
    "annotation": "\ud83e\udde0 ML Signal: Assertion to check specific attributes of the result",
    "confidence": 1.0,
    "tokens": [
      4299,
      1332,
      62,
      830,
      39761,
      62,
      28046,
      62,
      21949,
      62,
      49170,
      33529
    ],
    "start_token": 130,
    "end_token": 142,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      2195,
      861,
      295,
      284,
      2198,
      2176,
      12608,
      286,
      262,
      1255
    ],
    "label": "ml_signal",
    "reason": "Assertion to check specific attributes of the result"
  },
  {
    "line": 23,
    "text": "    latest: SpoDetail = result[0]",
    "annotation": "\ud83e\udde0 ML Signal: Use of a specific query pattern with parameters",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      3452,
      25,
      49331,
      11242,
      603,
      796,
      1255,
      58,
      15,
      60
    ],
    "start_token": 142,
    "end_token": 155,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      5765,
      286,
      257,
      2176,
      12405,
      3912,
      351,
      10007
    ],
    "label": "ml_signal",
    "reason": "Use of a specific query pattern with parameters"
  },
  {
    "line": 23,
    "text": "    latest: SpoDetail = result[0]",
    "annotation": "\ud83e\udde0 ML Signal: Use of session and provider parameters in data query",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      3452,
      25,
      49331,
      11242,
      603,
      796,
      1255,
      58,
      15,
      60
    ],
    "start_token": 155,
    "end_token": 168,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      5765,
      286,
      6246,
      290,
      10131,
      10007,
      287,
      1366,
      12405
    ],
    "label": "ml_signal",
    "reason": "Use of session and provider parameters in data query"
  },
  {
    "line": 31,
    "text": "def test_000778_rights_issue_detail():",
    "annotation": "\ud83e\udde0 ML Signal: Use of ordering in query",
    "confidence": 0.5,
    "tokens": [
      4299,
      1332,
      62,
      830,
      39761,
      62,
      28046,
      62,
      21949,
      62,
      49170,
      33529
    ],
    "start_token": 168,
    "end_token": 180,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      5765,
      286,
      16216,
      287,
      12405
    ],
    "label": "ml_signal",
    "reason": "Use of ordering in query"
  },
  {
    "line": 34,
    "text": "        provider=\"eastmoney\",",
    "annotation": "\u26a0\ufe0f SAST Risk (Low): Potential for assertion to fail if data changes",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      10131,
      2625,
      23316,
      26316,
      1600
    ],
    "start_token": 180,
    "end_token": 192,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      20535,
      2599,
      32480,
      329,
      19190,
      284,
      2038,
      611,
      1366,
      2458
    ],
    "label": "sast_risk",
    "severity": "Low",
    "reason": "Potential for assertion to fail if data changes"
  },
  {
    "line": 36,
    "text": "        codes=[\"000778\"],",
    "annotation": "\u2705 Best Practice: Type hinting for better code readability and maintainability",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      12416,
      28,
      14692,
      830,
      39761,
      33116
    ],
    "start_token": 192,
    "end_token": 205,
    "annotation_tokens": [
      26486,
      227,
      6705,
      19939,
      25,
      5994,
      9254,
      278,
      329,
      1365,
      2438,
      1100,
      1799,
      290,
      5529,
      1799
    ],
    "label": "best_practice",
    "reason": "Type hinting for better code readability and maintainability"
  },
  {
    "line": 38,
    "text": "        order=RightsIssueDetail.timestamp.desc(),",
    "annotation": "\u26a0\ufe0f SAST Risk (Low): Potential for assertion to fail if data changes",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      1502,
      28,
      49,
      2337,
      45147,
      11242,
      603,
      13,
      16514,
      27823,
      13,
      20147,
      22784
    ],
    "start_token": 205,
    "end_token": 225,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      20535,
      2599,
      32480,
      329,
      19190,
      284,
      2038,
      611,
      1366,
      2458
    ],
    "label": "sast_risk",
    "severity": "Low",
    "reason": "Potential for assertion to fail if data changes"
  },
  {
    "line": 38,
    "text": "        order=RightsIssueDetail.timestamp.desc(),",
    "annotation": "\u26a0\ufe0f SAST Risk (Low): Potential for assertion to fail if data changes",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      1502,
      28,
      49,
      2337,
      45147,
      11242,
      603,
      13,
      16514,
      27823,
      13,
      20147,
      22784
    ],
    "start_token": 225,
    "end_token": 245,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      20535,
      2599,
      32480,
      329,
      19190,
      284,
      2038,
      611,
      1366,
      2458
    ],
    "label": "sast_risk",
    "severity": "Low",
    "reason": "Potential for assertion to fail if data changes"
  },
  {
    "line": 38,
    "text": "        order=RightsIssueDetail.timestamp.desc(),",
    "annotation": "\u26a0\ufe0f SAST Risk (Low): Potential for assertion to fail if data changes",
    "confidence": 0.5,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      1502,
      28,
      49,
      2337,
      45147,
      11242,
      603,
      13,
      16514,
      27823,
      13,
      20147,
      22784
    ],
    "start_token": 245,
    "end_token": 265,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      20535,
      2599,
      32480,
      329,
      19190,
      284,
      2038,
      611,
      1366,
      2458
    ],
    "label": "sast_risk",
    "severity": "Low",
    "reason": "Potential for assertion to fail if data changes"
  },
  {
    "line": 46,
    "text": "",
    "annotation": "\u26a0\ufe0f SAST Risk (Low): Potential for assertion to fail if data changes",
    "confidence": 0.5,
    "tokens": [],
    "start_token": 265,
    "end_token": 265,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      20535,
      2599,
      32480,
      329,
      19190,
      284,
      2038,
      611,
      1366,
      2458
    ],
    "label": "sast_risk",
    "severity": "Low",
    "reason": "Potential for assertion to fail if data changes"
  },
  {
    "line": 37,
    "text": "        end_timestamp=\"2018-09-30\",",
    "annotation": "\ud83e\udde0 ML Signal: Function name follows a pattern that could indicate a test case",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      886,
      62,
      16514,
      27823,
      2625,
      7908,
      12,
      2931,
      12,
      1270,
      1600
    ],
    "start_token": 265,
    "end_token": 283,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      15553,
      1438,
      5679,
      257,
      3912,
      326,
      714,
      7603,
      257,
      1332,
      1339
    ],
    "label": "ml_signal",
    "reason": "Function name follows a pattern that could indicate a test case"
  },
  {
    "line": 38,
    "text": "        order=RightsIssueDetail.timestamp.desc(),",
    "annotation": "\ud83e\udde0 ML Signal: Use of a query method to retrieve data",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      1502,
      28,
      49,
      2337,
      45147,
      11242,
      603,
      13,
      16514,
      27823,
      13,
      20147,
      22784
    ],
    "start_token": 283,
    "end_token": 303,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      5765,
      286,
      257,
      12405,
      2446,
      284,
      19818,
      1366
    ],
    "label": "ml_signal",
    "reason": "Use of a query method to retrieve data"
  },
  {
    "line": 38,
    "text": "        order=RightsIssueDetail.timestamp.desc(),",
    "annotation": "\u26a0\ufe0f SAST Risk (Low): Potential for SQL injection if inputs are not sanitized",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      1502,
      28,
      49,
      2337,
      45147,
      11242,
      603,
      13,
      16514,
      27823,
      13,
      20147,
      22784
    ],
    "start_token": 303,
    "end_token": 323,
    "annotation_tokens": [
      158,
      248,
      254,
      37929,
      311,
      11262,
      19602,
      357,
      20535,
      2599,
      32480,
      329,
      16363,
      16954,
      611,
      17311,
      389,
      407,
      5336,
      36951
    ],
    "label": "sast_risk",
    "severity": "Low",
    "reason": "Potential for SQL injection if inputs are not sanitized"
  },
  {
    "line": 38,
    "text": "        order=RightsIssueDetail.timestamp.desc(),",
    "annotation": "\ud83e\udde0 ML Signal: Use of session object indicates a database interaction",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      1502,
      28,
      49,
      2337,
      45147,
      11242,
      603,
      13,
      16514,
      27823,
      13,
      20147,
      22784
    ],
    "start_token": 323,
    "end_token": 343,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      5765,
      286,
      6246,
      2134,
      9217,
      257,
      6831,
      10375
    ],
    "label": "ml_signal",
    "reason": "Use of session object indicates a database interaction"
  },
  {
    "line": 48,
    "text": "# \u5206\u7ea2\u878d\u8d44",
    "annotation": "\ud83e\udde0 ML Signal: Use of order by clause in query",
    "confidence": 1.0,
    "tokens": [
      2,
      10263,
      230,
      228,
      163,
      118,
      95,
      164,
      252,
      235,
      164,
      113,
      226
    ],
    "start_token": 343,
    "end_token": 356,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      5765,
      286,
      1502,
      416,
      13444,
      287,
      12405
    ],
    "label": "ml_signal",
    "reason": "Use of order by clause in query"
  },
  {
    "line": 51,
    "text": "        session=session,",
    "annotation": "\ud83e\udde0 ML Signal: Use of assert statements for validation",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      6246,
      28,
      29891,
      11
    ],
    "start_token": 356,
    "end_token": 367,
    "annotation_tokens": [
      8582,
      100,
      254,
      10373,
      26484,
      25,
      5765,
      286,
      6818,
      6299,
      329,
      21201
    ],
    "label": "ml_signal",
    "reason": "Use of assert statements for validation"
  },
  {
    "line": 52,
    "text": "        provider=\"eastmoney\",",
    "annotation": "\u2705 Best Practice: Type hinting for better code readability and maintainability",
    "confidence": 1.0,
    "tokens": [
      220,
      220,
      220,
      220,
      220,
      220,
      220,
      10131,
      2625,
      23316,
      26316,
      1600
    ],
    "start_token": 367,
    "end_token": 379,
    "annotation_tokens": [
      26486,
      227,
      6705,
      19939,
      25,
      5994,
      9254,
      278,
      329,
      1365,
      2438,
      1100,
      1799,
      290,
      5529,
      1799
    ],
    "label": "best_practice",
    "reason": "Type hinting for better code readability and maintainability"
  }
]