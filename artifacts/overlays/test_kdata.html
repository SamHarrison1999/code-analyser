<!doctype html><meta charset='utf-8'><title>test_kdata – overlay</title><div style='max-width:980px;margin:24px auto'><h3 style='font-family:Inter,system-ui'>File: test_kdata</h3><div><span style='padding:2px 6px;border-radius:10px;border:1px solid #888;margin-right:6px'>sast_risk: 0.55</span><span style='padding:2px 6px;border-radius:10px;border:1px solid #888;margin-right:6px'>ml_signal: 0.46</span><span style='padding:2px 6px;border-radius:10px;border:1px solid #888;margin-right:6px'>best_practice: 0.62</span></div><pre style='background:#0b1021;color:#ebedf5;padding:12px;border-radius:8px;overflow:auto;font-size:12px;line-height:1.4'># -*- coding: utf-8 -*-
from zvt.api.kdata import get_kdata
from zvt.api.kdata import get_latest_kdata_date
from zvt.contract import IntervalLevel, AdjustType


def test_jq_1mon_kdata():
    df = get_kdata(entity_id="stock_sz_000338", provider="joinquant", level=IntervalLevel.LEVEL_1MON)
    se = df.loc["2010-01-29"]
    # make sure our fq is ok
    assert round(se["open"], 2) &lt;= 5.44
    assert round(se["high"], 2) &lt;= 6.43
    assert round(se["low"], 2) &lt;= 5.2
    assert round(se["close"], 2) &lt;= 5.45


def test_jq_1wk_kdata():
    df = get_kdata(entity_id="stock_sz_000338", provider="joinquant", level=IntervalLevel.LEVEL_1WEEK)
    print(df)


def test_jq_1d_kdata():
    df = get_kdata(entity_id="stock_sz_000338", provider="joinquant", level=IntervalLevel.LEVEL_1DAY)
    print(df)

    se = df.loc["2019-04-08"]
    # make sure our fq is ok
    assert round(se["open"], 2) &lt;= 12.86
    assert round(se["high"], 2) &lt;= 14.16
    assert round(se["low"], 2) &lt;= 12.86
    assert round(se["close"], 2) &lt;= 14.08


def test_jq_1d_hfq_kdata():
    df = get_kdata(entity_id="stock_sz_000338", provider="joinquant", level=IntervalLevel.LEVEL_1DAY, adjust_type="hfq")
    se = df.loc["2019-04-08"]
    print(se)
    assert round(se["open"], 2) == 249.29
    assert round(se["high"], 2) == 273.68
    assert round(se["low"], 2) == 249.29
    assert round(se["close"], 2) == 272.18


def test_get_latest_kdata_date():
    date = get_latest_kdata_date(provider="joinquant", entity_type="stock", adjust_type=AdjustType.hfq)
    assert date is not None
</pre><div style='color:#666;font-size:12px'>Threshold 0.50. Ticks on dashboard indicate predictions ≥ threshold.</div></div>