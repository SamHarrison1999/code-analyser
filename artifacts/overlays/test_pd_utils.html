<!doctype html><meta charset='utf-8'><title>test_pd_utils – overlay</title><div style='max-width:980px;margin:24px auto'><h3 style='font-family:Inter,system-ui'>File: test_pd_utils</h3><div><span style='padding:2px 6px;border-radius:10px;border:1px solid #888;margin-right:6px'>sast_risk: 0.40</span><span style='padding:2px 6px;border-radius:10px;border:1px solid #888;margin-right:6px'>ml_signal: 0.49</span><span style='padding:2px 6px;border-radius:10px;border:1px solid #888;margin-right:6px'>best_practice: 0.58</span></div><pre style='background:#0b1021;color:#ebedf5;padding:12px;border-radius:8px;overflow:auto;font-size:12px;line-height:1.4'># -*- coding: utf-8 -*-
import pandas as pd

from zvt.utils.pd_utils import drop_continue_duplicate


def test_drop_continue_duplicate():
    data1 = [1, 2, 2, 3, 4, 4, 5]
    s = pd.Series(data=data1)
    s1 = drop_continue_duplicate(s=s)
    assert s1.tolist() == [1, 2, 3, 4, 5]

    data2 = [1, 2, 2, 2, 4, 4, 5]

    df = pd.DataFrame(data={"A": data1, "B": data2})
    print(df)
    df1 = drop_continue_duplicate(s=df, col="A")
    assert df1["A"].tolist() == [1, 2, 3, 4, 5]

    df2 = drop_continue_duplicate(s=df, col="B")
    assert df2["A"].tolist() == [1, 2, 4, 5]
</pre><div style='color:#666;font-size:12px'>Threshold 0.30. Ticks on dashboard indicate predictions ≥ threshold.</div></div>
