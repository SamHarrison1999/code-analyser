<!doctype html><meta charset='utf-8'><title>test_stock_money_flow – overlay</title><div style='max-width:980px;margin:24px auto'><h3 style='font-family:Inter,system-ui'>File: test_stock_money_flow</h3><div><span style='padding:2px 6px;border-radius:10px;border:1px solid #888;margin-right:6px'>sast_risk: 0.40</span><span style='padding:2px 6px;border-radius:10px;border:1px solid #888;margin-right:6px'>ml_signal: 0.50</span><span style='padding:2px 6px;border-radius:10px;border:1px solid #888;margin-right:6px'>best_practice: 0.59</span></div><pre style='background:#0b1021;color:#ebedf5;padding:12px;border-radius:8px;overflow:auto;font-size:12px;line-height:1.4'># -*- coding: utf-8 -*-
from zvt.domain import StockMoneyFlow, Stock


def test_stock_money_flow():
    provider = "joinquant"
    # Stock.record_data(provider=provider)
    StockMoneyFlow.record_data(
        codes=["300999", "688981"], provider=provider, start_timestamp="2020-12-14", compute_index_money_flow=False
    )

    data_samples = [
        {
            "id": "stock_sz_300999_2020-12-14",
            "timestamp": "2020-12-14",
            "code": "300999",
            "net_main_inflows": 46378.96 * 10000,
            "net_main_inflow_rate": 9.3 / 100,
            "net_huge_inflows": 50111.54 * 10000,
            "net_huge_inflow_rate": 10.04 / 100,
            "net_big_inflows": -3732.58 * 10000,
            "net_big_inflow_rate": -0.75 / 100,
            "net_medium_inflows": -23493.71 * 10000,
            "net_medium_inflow_rate": -4.71 / 100,
            "net_small_inflows": -22885.25 * 10000,
            "net_small_inflow_rate": -4.59 / 100,
        },
        {
            "id": "stock_sh_688981_2020-12-14",
            "timestamp": "2020-12-14",
            "code": "688981",
            "net_main_inflows": -14523.55 * 10000,
            "net_main_inflow_rate": -10.77 / 100,
            "net_huge_inflows": -17053.72 * 10000,
            "net_huge_inflow_rate": -12.65 / 100,
            "net_big_inflows": 2530.17 * 10000,
            "net_big_inflow_rate": 1.88 / 100,
            "net_medium_inflows": 6945.23 * 10000,
            "net_medium_inflow_rate": 5.15 / 100,
            "net_small_inflows": 7578.32 * 10000,
            "net_small_inflow_rate": 5.62 / 100,
        },
    ]
    StockMoneyFlow.test_data_correctness(provider=provider, data_samples=data_samples)
</pre><div style='color:#666;font-size:12px'>Threshold 0.30. Ticks on dashboard indicate predictions ≥ threshold.</div></div>
